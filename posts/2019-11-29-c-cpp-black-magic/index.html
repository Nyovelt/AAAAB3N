<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>编译时你在做什么？有没有空？可以来拯救吗？ | canarypwn</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="编译时你在做什么？有没有空？可以来拯救吗？"><meta property="og:description" content="太陽の傾いたこの世界で 通常写程序的时候，我们会更关注于程序的代码(main.c)和最终形成的可执行文件(main)。对于程序员来说，这两个部分的确是最重要的，甚至说90%的情况下都不用去管其它部分。现代的编译器非常智能，它们会帮你处理好很多东西（表扬 clang [klæŋ] ) 。但是，在编译的过程中，除了你的源代码和最终的可执行程序，其它部分，也就是编译器做的那部分，也应该得到关注。所以，这次的workshop将会关注程序运行背后的故事。事实上，有很多bug是因为忽视了编译器的运作原理而导致的。
现在我们学的大部分语言都是高级语言，而CPU认的却是二进制的机器码。当我们在编译程序的时候，编译器会将我们的高级语言翻译成低级的汇编语言。而在程序运行的时候，会将汇编语言翻译成机器码。这是程序的运作原理。
この戦いが終わったら C作为一门不会对内存检查的语言，因此很多的操作会超出一个变量的边界去影响下一个变量，举一个例子：
有没有什么办法来改变变量modified的值呢？
可以同时输入10个A 和11个A 来康康结果：
可以看到，在输入了超过10个字符后，modified的值被改变了。原因在于数据的存储方式。计算机中有一个叫内存空间的东西，它存放着所有的变量。一般情况下，一个变量将会分字节存在内存空间中，如左图所示。而buffer[10] 开辟了10个字节的内存空间，modified在buffer[10]上面开辟了4个字节的空间（通常指x86，数据是这么排列在计算机中的）。当我们输入了10个A以后，buffer[10]的内存空间被用完了，而gets()函数并不会对空间的边界进行检查，所以当第11个A输入了以后，A被挤到了(int)modified的内存空间，所以原本是0的modified不再是0（实际上modified的值 是 A的askll值 65 ）所以gets非常不安全当然这是非常特殊的情况，因为我们一般用的是cin或者scanf甚至在VS中用的是更加安全的scanf_s。
同样的，cin的运作原理也可以这么解释：在输入回车之前，所有的输入都会存在一个缓冲区中，程序会根据分隔符或者变量类型来选择读入合适的数据。ifstream 同理。
这个程序是一个很简单的堆栈溢出的例子，我觉得它对理解 内存空间有一定帮助。
说到这里，Stackoverflow 直译过来就是堆栈溢出 XD。
​	而在这个具体的例子中：内存空间（栈）是这样的：
可以看出，内存的排列顺序是自下而上的，或者说叫做小端序。将会有一个叫做栈指针的指针指向当前的内存并对内存进行操作。
有诗云：手持两把锟斤拷 口中疾呼烫烫烫 脚踏千朵屯屯屯 笑看万物锘锘锘
我们非常熟悉的“烫烫烫”只有在Microsodt VC 在的debug 模式下才会出现。 VC会把未使用的内存空间全部填入 0xCC ，比如在声明变量却没有赋值而且还调用的情况下。在中文的环境下，与askll码对于一个字节不同，中文字符对于两个字节。 而在GBK内码下（类似askll码 ， 将二进制数 转化为中文字符 ）， 0xCCCC 对应的中文字符就是 烫
空の上の森の中の 所以编译器到底在干什么？
很多人都听说了C是一种高级语言，编译器把高级语言翻译成低级语言，操作系统把低级语言翻译成机器码。
那么我们可以看一看编译器翻译后的代码，来关注一下程序到底是什么运作的。
一般情况下，我们可以直接调用编译器来输出汇编代码，以helloworld.c为例。
打开终端，输入命令
$ gcc -S helloworld.c -Og -masm=intel   gcc 代表使用的编译器， gcc编译C files, g++编译 Cpp files， 类似的还有clang 和 clang++)"><meta property="og:type" content="article"><meta property="og:url" content="https://aaaab3n.moe/posts/2019-11-29-c-cpp-black-magic/"><meta property="article:published_time" content="2019-11-29T12:55:35+08:00"><meta property="article:modified_time" content="2019-11-29T12:55:35+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="编译时你在做什么？有没有空？可以来拯救吗？"><meta name=twitter:description content="太陽の傾いたこの世界で 通常写程序的时候，我们会更关注于程序的代码(main.c)和最终形成的可执行文件(main)。对于程序员来说，这两个部分的确是最重要的，甚至说90%的情况下都不用去管其它部分。现代的编译器非常智能，它们会帮你处理好很多东西（表扬 clang [klæŋ] ) 。但是，在编译的过程中，除了你的源代码和最终的可执行程序，其它部分，也就是编译器做的那部分，也应该得到关注。所以，这次的workshop将会关注程序运行背后的故事。事实上，有很多bug是因为忽视了编译器的运作原理而导致的。
现在我们学的大部分语言都是高级语言，而CPU认的却是二进制的机器码。当我们在编译程序的时候，编译器会将我们的高级语言翻译成低级的汇编语言。而在程序运行的时候，会将汇编语言翻译成机器码。这是程序的运作原理。
この戦いが終わったら C作为一门不会对内存检查的语言，因此很多的操作会超出一个变量的边界去影响下一个变量，举一个例子：
有没有什么办法来改变变量modified的值呢？
可以同时输入10个A 和11个A 来康康结果：
可以看到，在输入了超过10个字符后，modified的值被改变了。原因在于数据的存储方式。计算机中有一个叫内存空间的东西，它存放着所有的变量。一般情况下，一个变量将会分字节存在内存空间中，如左图所示。而buffer[10] 开辟了10个字节的内存空间，modified在buffer[10]上面开辟了4个字节的空间（通常指x86，数据是这么排列在计算机中的）。当我们输入了10个A以后，buffer[10]的内存空间被用完了，而gets()函数并不会对空间的边界进行检查，所以当第11个A输入了以后，A被挤到了(int)modified的内存空间，所以原本是0的modified不再是0（实际上modified的值 是 A的askll值 65 ）所以gets非常不安全当然这是非常特殊的情况，因为我们一般用的是cin或者scanf甚至在VS中用的是更加安全的scanf_s。
同样的，cin的运作原理也可以这么解释：在输入回车之前，所有的输入都会存在一个缓冲区中，程序会根据分隔符或者变量类型来选择读入合适的数据。ifstream 同理。
这个程序是一个很简单的堆栈溢出的例子，我觉得它对理解 内存空间有一定帮助。
说到这里，Stackoverflow 直译过来就是堆栈溢出 XD。
​	而在这个具体的例子中：内存空间（栈）是这样的：
可以看出，内存的排列顺序是自下而上的，或者说叫做小端序。将会有一个叫做栈指针的指针指向当前的内存并对内存进行操作。
有诗云：手持两把锟斤拷 口中疾呼烫烫烫 脚踏千朵屯屯屯 笑看万物锘锘锘
我们非常熟悉的“烫烫烫”只有在Microsodt VC 在的debug 模式下才会出现。 VC会把未使用的内存空间全部填入 0xCC ，比如在声明变量却没有赋值而且还调用的情况下。在中文的环境下，与askll码对于一个字节不同，中文字符对于两个字节。 而在GBK内码下（类似askll码 ， 将二进制数 转化为中文字符 ）， 0xCCCC 对应的中文字符就是 烫
空の上の森の中の 所以编译器到底在干什么？
很多人都听说了C是一种高级语言，编译器把高级语言翻译成低级语言，操作系统把低级语言翻译成机器码。
那么我们可以看一看编译器翻译后的代码，来关注一下程序到底是什么运作的。
一般情况下，我们可以直接调用编译器来输出汇编代码，以helloworld.c为例。
打开终端，输入命令
$ gcc -S helloworld.c -Og -masm=intel   gcc 代表使用的编译器， gcc编译C files, g++编译 Cpp files， 类似的还有clang 和 clang++)"><link rel=stylesheet href=https://aaaab3n.moe/css/style-white.css><link href="http://fonts.loli.net/css?family=Roboto" rel=stylesheet type=text/css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://aaaab3n.moe/images/favicon.ico><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','G-73VZSQL8QT','auto');ga('send','pageview');}</script></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a><a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a><a id=top-icon-tablet href=# onclick="$('html, body').animate({scrollTop:0},'fast');" style=display:none><i class="fas fa-chevron-up fa-lg"></i></a><span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=/posts>Posts</a></li><li><a href=/tags>Tags</a></li><li><a href=/networks>Network</a></li><li><a href=/notes>Notes</a></li><li><a href=https://500px.com/p/nyovelt>Images</a></li><li><a href=/friends>Friends</a></li><li><a href=https://who.aaaab3n.moe/>About</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://aaaab3n.moe/posts/2019-2-18-the-wandering-earth/><i class="fas fa-chevron-left" aria-hidden=true onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li><li><a class=icon href=https://aaaab3n.moe/posts/2019-12-31-2020-say-hello/><i class="fas fa-chevron-right" aria-hidden=true onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li><li><a class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast');"><i class="fas fa-chevron-up" aria-hidden=true onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li><li><a class=icon href=#><i class="fas fa-share-alt" aria-hidden=true onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2faaaab3n.moe%2fposts%2f2019-11-29-c-cpp-black-magic%2f"><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2faaaab3n.moe%2fposts%2f2019-11-29-c-cpp-black-magic%2f&text=%e7%bc%96%e8%af%91%e6%97%b6%e4%bd%a0%e5%9c%a8%e5%81%9a%e4%bb%80%e4%b9%88%ef%bc%9f%e6%9c%89%e6%b2%a1%e6%9c%89%e7%a9%ba%ef%bc%9f%e5%8f%af%e4%bb%a5%e6%9d%a5%e6%8b%af%e6%95%91%e5%90%97%ef%bc%9f"><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2faaaab3n.moe%2fposts%2f2019-11-29-c-cpp-black-magic%2f&title=%e7%bc%96%e8%af%91%e6%97%b6%e4%bd%a0%e5%9c%a8%e5%81%9a%e4%bb%80%e4%b9%88%ef%bc%9f%e6%9c%89%e6%b2%a1%e6%9c%89%e7%a9%ba%ef%bc%9f%e5%8f%af%e4%bb%a5%e6%9d%a5%e6%8b%af%e6%95%91%e5%90%97%ef%bc%9f"><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2faaaab3n.moe%2fposts%2f2019-11-29-c-cpp-black-magic%2f&is_video=false&description=%e7%bc%96%e8%af%91%e6%97%b6%e4%bd%a0%e5%9c%a8%e5%81%9a%e4%bb%80%e4%b9%88%ef%bc%9f%e6%9c%89%e6%b2%a1%e6%9c%89%e7%a9%ba%ef%bc%9f%e5%8f%af%e4%bb%a5%e6%9d%a5%e6%8b%af%e6%95%91%e5%90%97%ef%bc%9f"><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=%e7%bc%96%e8%af%91%e6%97%b6%e4%bd%a0%e5%9c%a8%e5%81%9a%e4%bb%80%e4%b9%88%ef%bc%9f%e6%9c%89%e6%b2%a1%e6%9c%89%e7%a9%ba%ef%bc%9f%e5%8f%af%e4%bb%a5%e6%9d%a5%e6%8b%af%e6%95%91%e5%90%97%ef%bc%9f&body=Check out this article: https%3a%2f%2faaaab3n.moe%2fposts%2f2019-11-29-c-cpp-black-magic%2f"><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2faaaab3n.moe%2fposts%2f2019-11-29-c-cpp-black-magic%2f&title=%e7%bc%96%e8%af%91%e6%97%b6%e4%bd%a0%e5%9c%a8%e5%81%9a%e4%bb%80%e4%b9%88%ef%bc%9f%e6%9c%89%e6%b2%a1%e6%9c%89%e7%a9%ba%ef%bc%9f%e5%8f%af%e4%bb%a5%e6%9d%a5%e6%8b%af%e6%95%91%e5%90%97%ef%bc%9f"><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2faaaab3n.moe%2fposts%2f2019-11-29-c-cpp-black-magic%2f&title=%e7%bc%96%e8%af%91%e6%97%b6%e4%bd%a0%e5%9c%a8%e5%81%9a%e4%bb%80%e4%b9%88%ef%bc%9f%e6%9c%89%e6%b2%a1%e6%9c%89%e7%a9%ba%ef%bc%9f%e5%8f%af%e4%bb%a5%e6%9d%a5%e6%8b%af%e6%95%91%e5%90%97%ef%bc%9f"><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2faaaab3n.moe%2fposts%2f2019-11-29-c-cpp-black-magic%2f&name=%e7%bc%96%e8%af%91%e6%97%b6%e4%bd%a0%e5%9c%a8%e5%81%9a%e4%bb%80%e4%b9%88%ef%bc%9f%e6%9c%89%e6%b2%a1%e6%9c%89%e7%a9%ba%ef%bc%9f%e5%8f%af%e4%bb%a5%e6%9d%a5%e6%8b%af%e6%95%91%e5%90%97%ef%bc%9f&description=%e5%a4%aa%e9%99%bd%e3%81%ae%e5%82%be%e3%81%84%e3%81%9f%e3%81%93%e3%81%ae%e4%b8%96%e7%95%8c%e3%81%a7%20%e9%80%9a%e5%b8%b8%e5%86%99%e7%a8%8b%e5%ba%8f%e7%9a%84%e6%97%b6%e5%80%99%ef%bc%8c%e6%88%91%e4%bb%ac%e4%bc%9a%e6%9b%b4%e5%85%b3%e6%b3%a8%e4%ba%8e%e7%a8%8b%e5%ba%8f%e7%9a%84%e4%bb%a3%e7%a0%81%28main.c%29%e5%92%8c%e6%9c%80%e7%bb%88%e5%bd%a2%e6%88%90%e7%9a%84%e5%8f%af%e6%89%a7%e8%a1%8c%e6%96%87%e4%bb%b6%28main%29%e3%80%82%e5%af%b9%e4%ba%8e%e7%a8%8b%e5%ba%8f%e5%91%98%e6%9d%a5%e8%af%b4%ef%bc%8c%e8%bf%99%e4%b8%a4%e4%b8%aa%e9%83%a8%e5%88%86%e7%9a%84%e7%a1%ae%e6%98%af%e6%9c%80%e9%87%8d%e8%a6%81%e7%9a%84%ef%bc%8c%e7%94%9a%e8%87%b3%e8%af%b490%25%e7%9a%84%e6%83%85%e5%86%b5%e4%b8%8b%e9%83%bd%e4%b8%8d%e7%94%a8%e5%8e%bb%e7%ae%a1%e5%85%b6%e5%ae%83%e9%83%a8%e5%88%86%e3%80%82%e7%8e%b0%e4%bb%a3%e7%9a%84%e7%bc%96%e8%af%91%e5%99%a8%e9%9d%9e%e5%b8%b8%e6%99%ba%e8%83%bd%ef%bc%8c%e5%ae%83%e4%bb%ac%e4%bc%9a%e5%b8%ae%e4%bd%a0%e5%a4%84%e7%90%86%e5%a5%bd%e5%be%88%e5%a4%9a%e4%b8%9c%e8%a5%bf%ef%bc%88%e8%a1%a8%e6%89%ac%20clang%20%5bkl%c3%a6%c5%8b%5d%20%29%20%e3%80%82%e4%bd%86%e6%98%af%ef%bc%8c%e5%9c%a8%e7%bc%96%e8%af%91%e7%9a%84%e8%bf%87%e7%a8%8b%e4%b8%ad%ef%bc%8c%e9%99%a4%e4%ba%86%e4%bd%a0%e7%9a%84%e6%ba%90%e4%bb%a3%e7%a0%81%e5%92%8c%e6%9c%80%e7%bb%88%e7%9a%84%e5%8f%af%e6%89%a7%e8%a1%8c%e7%a8%8b%e5%ba%8f%ef%bc%8c%e5%85%b6%e5%ae%83%e9%83%a8%e5%88%86%ef%bc%8c%e4%b9%9f%e5%b0%b1%e6%98%af%e7%bc%96%e8%af%91%e5%99%a8%e5%81%9a%e7%9a%84%e9%82%a3%e9%83%a8%e5%88%86%ef%bc%8c%e4%b9%9f%e5%ba%94%e8%af%a5%e5%be%97%e5%88%b0%e5%85%b3%e6%b3%a8%e3%80%82%e6%89%80%e4%bb%a5%ef%bc%8c%e8%bf%99%e6%ac%a1%e7%9a%84workshop%e5%b0%86%e4%bc%9a%e5%85%b3%e6%b3%a8%e7%a8%8b%e5%ba%8f%e8%bf%90%e8%a1%8c%e8%83%8c%e5%90%8e%e7%9a%84%e6%95%85%e4%ba%8b%e3%80%82%e4%ba%8b%e5%ae%9e%e4%b8%8a%ef%bc%8c%e6%9c%89%e5%be%88%e5%a4%9abug%e6%98%af%e5%9b%a0%e4%b8%ba%e5%bf%bd%e8%a7%86%e4%ba%86%e7%bc%96%e8%af%91%e5%99%a8%e7%9a%84%e8%bf%90%e4%bd%9c%e5%8e%9f%e7%90%86%e8%80%8c%e5%af%bc%e8%87%b4%e7%9a%84%e3%80%82%0a%e7%8e%b0%e5%9c%a8%e6%88%91%e4%bb%ac%e5%ad%a6%e7%9a%84%e5%a4%a7%e9%83%a8%e5%88%86%e8%af%ad%e8%a8%80%e9%83%bd%e6%98%af%e9%ab%98%e7%ba%a7%e8%af%ad%e8%a8%80%ef%bc%8c%e8%80%8cCPU%e8%ae%a4%e7%9a%84%e5%8d%b4%e6%98%af%e4%ba%8c%e8%bf%9b%e5%88%b6%e7%9a%84%e6%9c%ba%e5%99%a8%e7%a0%81%e3%80%82%e5%bd%93%e6%88%91%e4%bb%ac%e5%9c%a8%e7%bc%96%e8%af%91%e7%a8%8b%e5%ba%8f%e7%9a%84%e6%97%b6%e5%80%99%ef%bc%8c%e7%bc%96%e8%af%91%e5%99%a8%e4%bc%9a%e5%b0%86%e6%88%91%e4%bb%ac%e7%9a%84%e9%ab%98%e7%ba%a7%e8%af%ad%e8%a8%80%e7%bf%bb%e8%af%91%e6%88%90%e4%bd%8e%e7%ba%a7%e7%9a%84%e6%b1%87%e7%bc%96%e8%af%ad%e8%a8%80%e3%80%82%e8%80%8c%e5%9c%a8%e7%a8%8b%e5%ba%8f%e8%bf%90%e8%a1%8c%e7%9a%84%e6%97%b6%e5%80%99%ef%bc%8c%e4%bc%9a%e5%b0%86%e6%b1%87%e7%bc%96%e8%af%ad%e8%a8%80%e7%bf%bb%e8%af%91%e6%88%90%e6%9c%ba%e5%99%a8%e7%a0%81%e3%80%82%e8%bf%99%e6%98%af%e7%a8%8b%e5%ba%8f%e7%9a%84%e8%bf%90%e4%bd%9c%e5%8e%9f%e7%90%86%e3%80%82%0a%e3%81%93%e3%81%ae%e6%88%a6%e3%81%84%e3%81%8c%e7%b5%82%e3%82%8f%e3%81%a3%e3%81%9f%e3%82%89%20C%e4%bd%9c%e4%b8%ba%e4%b8%80%e9%97%a8%e4%b8%8d%e4%bc%9a%e5%af%b9%e5%86%85%e5%ad%98%e6%a3%80%e6%9f%a5%e7%9a%84%e8%af%ad%e8%a8%80%ef%bc%8c%e5%9b%a0%e6%ad%a4%e5%be%88%e5%a4%9a%e7%9a%84%e6%93%8d%e4%bd%9c%e4%bc%9a%e8%b6%85%e5%87%ba%e4%b8%80%e4%b8%aa%e5%8f%98%e9%87%8f%e7%9a%84%e8%be%b9%e7%95%8c%e5%8e%bb%e5%bd%b1%e5%93%8d%e4%b8%8b%e4%b8%80%e4%b8%aa%e5%8f%98%e9%87%8f%ef%bc%8c%e4%b8%be%e4%b8%80%e4%b8%aa%e4%be%8b%e5%ad%90%ef%bc%9a%0a%e6%9c%89%e6%b2%a1%e6%9c%89%e4%bb%80%e4%b9%88%e5%8a%9e%e6%b3%95%e6%9d%a5%e6%94%b9%e5%8f%98%e5%8f%98%e9%87%8fmodified%e7%9a%84%e5%80%bc%e5%91%a2%ef%bc%9f%0a%e5%8f%af%e4%bb%a5%e5%90%8c%e6%97%b6%e8%be%93%e5%85%a510%e4%b8%aaA%20%e5%92%8c11%e4%b8%aaA%20%e6%9d%a5%e5%ba%b7%e5%ba%b7%e7%bb%93%e6%9e%9c%ef%bc%9a%0a%e5%8f%af%e4%bb%a5%e7%9c%8b%e5%88%b0%ef%bc%8c%e5%9c%a8%e8%be%93%e5%85%a5%e4%ba%86%e8%b6%85%e8%bf%8710%e4%b8%aa%e5%ad%97%e7%ac%a6%e5%90%8e%ef%bc%8cmodified%e7%9a%84%e5%80%bc%e8%a2%ab%e6%94%b9%e5%8f%98%e4%ba%86%e3%80%82%e5%8e%9f%e5%9b%a0%e5%9c%a8%e4%ba%8e%e6%95%b0%e6%8d%ae%e7%9a%84%e5%ad%98%e5%82%a8%e6%96%b9%e5%bc%8f%e3%80%82%e8%ae%a1%e7%ae%97%e6%9c%ba%e4%b8%ad%e6%9c%89%e4%b8%80%e4%b8%aa%e5%8f%ab%e5%86%85%e5%ad%98%e7%a9%ba%e9%97%b4%e7%9a%84%e4%b8%9c%e8%a5%bf%ef%bc%8c%e5%ae%83%e5%ad%98%e6%94%be%e7%9d%80%e6%89%80%e6%9c%89%e7%9a%84%e5%8f%98%e9%87%8f%e3%80%82%e4%b8%80%e8%88%ac%e6%83%85%e5%86%b5%e4%b8%8b%ef%bc%8c%e4%b8%80%e4%b8%aa%e5%8f%98%e9%87%8f%e5%b0%86%e4%bc%9a%e5%88%86%e5%ad%97%e8%8a%82%e5%ad%98%e5%9c%a8%e5%86%85%e5%ad%98%e7%a9%ba%e9%97%b4%e4%b8%ad%ef%bc%8c%e5%a6%82%e5%b7%a6%e5%9b%be%e6%89%80%e7%a4%ba%e3%80%82%e8%80%8cbuffer%5b10%5d%20%e5%bc%80%e8%be%9f%e4%ba%8610%e4%b8%aa%e5%ad%97%e8%8a%82%e7%9a%84%e5%86%85%e5%ad%98%e7%a9%ba%e9%97%b4%ef%bc%8cmodified%e5%9c%a8buffer%5b10%5d%e4%b8%8a%e9%9d%a2%e5%bc%80%e8%be%9f%e4%ba%864%e4%b8%aa%e5%ad%97%e8%8a%82%e7%9a%84%e7%a9%ba%e9%97%b4%ef%bc%88%e9%80%9a%e5%b8%b8%e6%8c%87x86%ef%bc%8c%e6%95%b0%e6%8d%ae%e6%98%af%e8%bf%99%e4%b9%88%e6%8e%92%e5%88%97%e5%9c%a8%e8%ae%a1%e7%ae%97%e6%9c%ba%e4%b8%ad%e7%9a%84%ef%bc%89%e3%80%82%e5%bd%93%e6%88%91%e4%bb%ac%e8%be%93%e5%85%a5%e4%ba%8610%e4%b8%aaA%e4%bb%a5%e5%90%8e%ef%bc%8cbuffer%5b10%5d%e7%9a%84%e5%86%85%e5%ad%98%e7%a9%ba%e9%97%b4%e8%a2%ab%e7%94%a8%e5%ae%8c%e4%ba%86%ef%bc%8c%e8%80%8cgets%28%29%e5%87%bd%e6%95%b0%e5%b9%b6%e4%b8%8d%e4%bc%9a%e5%af%b9%e7%a9%ba%e9%97%b4%e7%9a%84%e8%be%b9%e7%95%8c%e8%bf%9b%e8%a1%8c%e6%a3%80%e6%9f%a5%ef%bc%8c%e6%89%80%e4%bb%a5%e5%bd%93%e7%ac%ac11%e4%b8%aaA%e8%be%93%e5%85%a5%e4%ba%86%e4%bb%a5%e5%90%8e%ef%bc%8cA%e8%a2%ab%e6%8c%a4%e5%88%b0%e4%ba%86%28int%29modified%e7%9a%84%e5%86%85%e5%ad%98%e7%a9%ba%e9%97%b4%ef%bc%8c%e6%89%80%e4%bb%a5%e5%8e%9f%e6%9c%ac%e6%98%af0%e7%9a%84modified%e4%b8%8d%e5%86%8d%e6%98%af0%ef%bc%88%e5%ae%9e%e9%99%85%e4%b8%8amodified%e7%9a%84%e5%80%bc%20%e6%98%af%20A%e7%9a%84askll%e5%80%bc%2065%20%ef%bc%89%e6%89%80%e4%bb%a5gets%e9%9d%9e%e5%b8%b8%e4%b8%8d%e5%ae%89%e5%85%a8%e5%bd%93%e7%84%b6%e8%bf%99%e6%98%af%e9%9d%9e%e5%b8%b8%e7%89%b9%e6%ae%8a%e7%9a%84%e6%83%85%e5%86%b5%ef%bc%8c%e5%9b%a0%e4%b8%ba%e6%88%91%e4%bb%ac%e4%b8%80%e8%88%ac%e7%94%a8%e7%9a%84%e6%98%afcin%e6%88%96%e8%80%85scanf%e7%94%9a%e8%87%b3%e5%9c%a8VS%e4%b8%ad%e7%94%a8%e7%9a%84%e6%98%af%e6%9b%b4%e5%8a%a0%e5%ae%89%e5%85%a8%e7%9a%84scanf_s%e3%80%82%0a%e5%90%8c%e6%a0%b7%e7%9a%84%ef%bc%8ccin%e7%9a%84%e8%bf%90%e4%bd%9c%e5%8e%9f%e7%90%86%e4%b9%9f%e5%8f%af%e4%bb%a5%e8%bf%99%e4%b9%88%e8%a7%a3%e9%87%8a%ef%bc%9a%e5%9c%a8%e8%be%93%e5%85%a5%e5%9b%9e%e8%bd%a6%e4%b9%8b%e5%89%8d%ef%bc%8c%e6%89%80%e6%9c%89%e7%9a%84%e8%be%93%e5%85%a5%e9%83%bd%e4%bc%9a%e5%ad%98%e5%9c%a8%e4%b8%80%e4%b8%aa%e7%bc%93%e5%86%b2%e5%8c%ba%e4%b8%ad%ef%bc%8c%e7%a8%8b%e5%ba%8f%e4%bc%9a%e6%a0%b9%e6%8d%ae%e5%88%86%e9%9a%94%e7%ac%a6%e6%88%96%e8%80%85%e5%8f%98%e9%87%8f%e7%b1%bb%e5%9e%8b%e6%9d%a5%e9%80%89%e6%8b%a9%e8%af%bb%e5%85%a5%e5%90%88%e9%80%82%e7%9a%84%e6%95%b0%e6%8d%ae%e3%80%82ifstream%20%e5%90%8c%e7%90%86%e3%80%82%0a%e8%bf%99%e4%b8%aa%e7%a8%8b%e5%ba%8f%e6%98%af%e4%b8%80%e4%b8%aa%e5%be%88%e7%ae%80%e5%8d%95%e7%9a%84%e5%a0%86%e6%a0%88%e6%ba%a2%e5%87%ba%e7%9a%84%e4%be%8b%e5%ad%90%ef%bc%8c%e6%88%91%e8%a7%89%e5%be%97%e5%ae%83%e5%af%b9%e7%90%86%e8%a7%a3%20%e5%86%85%e5%ad%98%e7%a9%ba%e9%97%b4%e6%9c%89%e4%b8%80%e5%ae%9a%e5%b8%ae%e5%8a%a9%e3%80%82%0a%e8%af%b4%e5%88%b0%e8%bf%99%e9%87%8c%ef%bc%8cStackoverflow%20%e7%9b%b4%e8%af%91%e8%bf%87%e6%9d%a5%e5%b0%b1%e6%98%af%e5%a0%86%e6%a0%88%e6%ba%a2%e5%87%ba%20XD%e3%80%82%0a%e2%80%8b%09%e8%80%8c%e5%9c%a8%e8%bf%99%e4%b8%aa%e5%85%b7%e4%bd%93%e7%9a%84%e4%be%8b%e5%ad%90%e4%b8%ad%ef%bc%9a%e5%86%85%e5%ad%98%e7%a9%ba%e9%97%b4%ef%bc%88%e6%a0%88%ef%bc%89%e6%98%af%e8%bf%99%e6%a0%b7%e7%9a%84%ef%bc%9a%0a%e5%8f%af%e4%bb%a5%e7%9c%8b%e5%87%ba%ef%bc%8c%e5%86%85%e5%ad%98%e7%9a%84%e6%8e%92%e5%88%97%e9%a1%ba%e5%ba%8f%e6%98%af%e8%87%aa%e4%b8%8b%e8%80%8c%e4%b8%8a%e7%9a%84%ef%bc%8c%e6%88%96%e8%80%85%e8%af%b4%e5%8f%ab%e5%81%9a%e5%b0%8f%e7%ab%af%e5%ba%8f%e3%80%82%e5%b0%86%e4%bc%9a%e6%9c%89%e4%b8%80%e4%b8%aa%e5%8f%ab%e5%81%9a%e6%a0%88%e6%8c%87%e9%92%88%e7%9a%84%e6%8c%87%e9%92%88%e6%8c%87%e5%90%91%e5%bd%93%e5%89%8d%e7%9a%84%e5%86%85%e5%ad%98%e5%b9%b6%e5%af%b9%e5%86%85%e5%ad%98%e8%bf%9b%e8%a1%8c%e6%93%8d%e4%bd%9c%e3%80%82%0a%e6%9c%89%e8%af%97%e4%ba%91%ef%bc%9a%e6%89%8b%e6%8c%81%e4%b8%a4%e6%8a%8a%e9%94%9f%e6%96%a4%e6%8b%b7%20%e5%8f%a3%e4%b8%ad%e7%96%be%e5%91%bc%e7%83%ab%e7%83%ab%e7%83%ab%20%e8%84%9a%e8%b8%8f%e5%8d%83%e6%9c%b5%e5%b1%af%e5%b1%af%e5%b1%af%20%e7%ac%91%e7%9c%8b%e4%b8%87%e7%89%a9%e9%94%98%e9%94%98%e9%94%98%0a%e6%88%91%e4%bb%ac%e9%9d%9e%e5%b8%b8%e7%86%9f%e6%82%89%e7%9a%84%e2%80%9c%e7%83%ab%e7%83%ab%e7%83%ab%e2%80%9d%e5%8f%aa%e6%9c%89%e5%9c%a8Microsodt%20VC%20%e5%9c%a8%e7%9a%84debug%20%e6%a8%a1%e5%bc%8f%e4%b8%8b%e6%89%8d%e4%bc%9a%e5%87%ba%e7%8e%b0%e3%80%82%20VC%e4%bc%9a%e6%8a%8a%e6%9c%aa%e4%bd%bf%e7%94%a8%e7%9a%84%e5%86%85%e5%ad%98%e7%a9%ba%e9%97%b4%e5%85%a8%e9%83%a8%e5%a1%ab%e5%85%a5%200xCC%20%ef%bc%8c%e6%af%94%e5%a6%82%e5%9c%a8%e5%a3%b0%e6%98%8e%e5%8f%98%e9%87%8f%e5%8d%b4%e6%b2%a1%e6%9c%89%e8%b5%8b%e5%80%bc%e8%80%8c%e4%b8%94%e8%bf%98%e8%b0%83%e7%94%a8%e7%9a%84%e6%83%85%e5%86%b5%e4%b8%8b%e3%80%82%e5%9c%a8%e4%b8%ad%e6%96%87%e7%9a%84%e7%8e%af%e5%a2%83%e4%b8%8b%ef%bc%8c%e4%b8%8easkll%e7%a0%81%e5%af%b9%e4%ba%8e%e4%b8%80%e4%b8%aa%e5%ad%97%e8%8a%82%e4%b8%8d%e5%90%8c%ef%bc%8c%e4%b8%ad%e6%96%87%e5%ad%97%e7%ac%a6%e5%af%b9%e4%ba%8e%e4%b8%a4%e4%b8%aa%e5%ad%97%e8%8a%82%e3%80%82%20%e8%80%8c%e5%9c%a8GBK%e5%86%85%e7%a0%81%e4%b8%8b%ef%bc%88%e7%b1%bb%e4%bc%bcaskll%e7%a0%81%20%ef%bc%8c%20%e5%b0%86%e4%ba%8c%e8%bf%9b%e5%88%b6%e6%95%b0%20%e8%bd%ac%e5%8c%96%e4%b8%ba%e4%b8%ad%e6%96%87%e5%ad%97%e7%ac%a6%20%ef%bc%89%ef%bc%8c%200xCCCC%20%e5%af%b9%e5%ba%94%e7%9a%84%e4%b8%ad%e6%96%87%e5%ad%97%e7%ac%a6%e5%b0%b1%e6%98%af%20%e7%83%ab%0a%e7%a9%ba%e3%81%ae%e4%b8%8a%e3%81%ae%e6%a3%ae%e3%81%ae%e4%b8%ad%e3%81%ae%20%e6%89%80%e4%bb%a5%e7%bc%96%e8%af%91%e5%99%a8%e5%88%b0%e5%ba%95%e5%9c%a8%e5%b9%b2%e4%bb%80%e4%b9%88%ef%bc%9f%0a%e5%be%88%e5%a4%9a%e4%ba%ba%e9%83%bd%e5%90%ac%e8%af%b4%e4%ba%86C%e6%98%af%e4%b8%80%e7%a7%8d%e9%ab%98%e7%ba%a7%e8%af%ad%e8%a8%80%ef%bc%8c%e7%bc%96%e8%af%91%e5%99%a8%e6%8a%8a%e9%ab%98%e7%ba%a7%e8%af%ad%e8%a8%80%e7%bf%bb%e8%af%91%e6%88%90%e4%bd%8e%e7%ba%a7%e8%af%ad%e8%a8%80%ef%bc%8c%e6%93%8d%e4%bd%9c%e7%b3%bb%e7%bb%9f%e6%8a%8a%e4%bd%8e%e7%ba%a7%e8%af%ad%e8%a8%80%e7%bf%bb%e8%af%91%e6%88%90%e6%9c%ba%e5%99%a8%e7%a0%81%e3%80%82%0a%e9%82%a3%e4%b9%88%e6%88%91%e4%bb%ac%e5%8f%af%e4%bb%a5%e7%9c%8b%e4%b8%80%e7%9c%8b%e7%bc%96%e8%af%91%e5%99%a8%e7%bf%bb%e8%af%91%e5%90%8e%e7%9a%84%e4%bb%a3%e7%a0%81%ef%bc%8c%e6%9d%a5%e5%85%b3%e6%b3%a8%e4%b8%80%e4%b8%8b%e7%a8%8b%e5%ba%8f%e5%88%b0%e5%ba%95%e6%98%af%e4%bb%80%e4%b9%88%e8%bf%90%e4%bd%9c%e7%9a%84%e3%80%82%0a%e4%b8%80%e8%88%ac%e6%83%85%e5%86%b5%e4%b8%8b%ef%bc%8c%e6%88%91%e4%bb%ac%e5%8f%af%e4%bb%a5%e7%9b%b4%e6%8e%a5%e8%b0%83%e7%94%a8%e7%bc%96%e8%af%91%e5%99%a8%e6%9d%a5%e8%be%93%e5%87%ba%e6%b1%87%e7%bc%96%e4%bb%a3%e7%a0%81%ef%bc%8c%e4%bb%a5helloworld.c%e4%b8%ba%e4%be%8b%e3%80%82%0a%e6%89%93%e5%bc%80%e7%bb%88%e7%ab%af%ef%bc%8c%e8%be%93%e5%85%a5%e5%91%bd%e4%bb%a4%0a%24%20gcc%20-S%20helloworld.c%20-Og%20-masm%3dintel%20%20%20gcc%20%e4%bb%a3%e8%a1%a8%e4%bd%bf%e7%94%a8%e7%9a%84%e7%bc%96%e8%af%91%e5%99%a8%ef%bc%8c%20gcc%e7%bc%96%e8%af%91C%20files%2c%20g%2b%2b%e7%bc%96%e8%af%91%20Cpp%20files%ef%bc%8c%20%e7%b1%bb%e4%bc%bc%e7%9a%84%e8%bf%98%e6%9c%89clang%20%e5%92%8c%20clang%2b%2b%29"><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2faaaab3n.moe%2fposts%2f2019-11-29-c-cpp-black-magic%2f&t=%e7%bc%96%e8%af%91%e6%97%b6%e4%bd%a0%e5%9c%a8%e5%81%9a%e4%bb%80%e4%b9%88%ef%bc%9f%e6%9c%89%e6%b2%a1%e6%9c%89%e7%a9%ba%ef%bc%9f%e5%8f%af%e4%bb%a5%e6%9d%a5%e6%8b%af%e6%95%91%e5%90%97%ef%bc%9f"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#太陽の傾いたこの世界で>太陽の傾いたこの世界で</a></li><li><a href=#この戦いが終わったら>この戦いが終わったら</a></li><li><a href=#空の上の森の中の>空の上の森の中の</a></li><li><a href=#帰らぬ者と待ち続けた者たち>帰らぬ者と、待ち続けた者たち</a></li><li><a href=#ただいま帰りました>ただいま帰りました</a></li><li><a href=#どうか忘れないで>どうか、忘れないで</a><ul><li><a href=#设计模式>设计模式</a></li></ul></li><li><a href=#参考>参考</a></li><li><a href=#感谢>感谢</a></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">编译时你在做什么？有没有空？可以来拯救吗？</h1><div class=meta><div class=postdate><time datetime="2019-11-29 12:55:35 +0800 +0800" itemprop=datePublished>2019-11-29</time></div></div></header><div class=content itemprop=articleBody><h2 id=太陽の傾いたこの世界で>太陽の傾いたこの世界で</h2><p>通常写程序的时候，我们会更关注于程序的代码(main.c)和最终形成的可执行文件(main)。对于程序员来说，这两个部分的确是最重要的，甚至说90%的情况下都不用去管其它部分。现代的编译器非常智能，它们会帮你处理好很多东西（表扬 clang [klæŋ] ) 。但是，在编译的过程中，除了你的源代码和最终的可执行程序，其它部分，也就是编译器做的那部分，也应该得到关注。所以，这次的workshop将会关注程序运行背后的故事。事实上，有很多bug是因为忽视了编译器的运作原理而导致的。</p><p><img src=https://i.loli.net/2019/12/05/xXSCbpR1ckPz79W.png alt=1575551248676.png></p><p>现在我们学的大部分语言都是高级语言，而CPU认的却是二进制的机器码。当我们在编译程序的时候，编译器会将我们的高级语言翻译成低级的汇编语言。而在程序运行的时候，会将汇编语言翻译成机器码。这是程序的运作原理。</p><h2 id=この戦いが終わったら>この戦いが終わったら</h2><p>C作为一门不会对内存检查的语言，因此很多的操作会超出一个变量的边界去影响下一个变量，举一个例子：</p><p><img src=https://i.loli.net/2019/12/12/ZteunrBacgklOs5.png alt=pwn></p><p>有没有什么办法来改变变量<code>modified</code>的值呢？</p><p>可以同时输入10个A 和11个A 来康康结果：</p><p><img src=https://i.loli.net/2019/12/12/aSjPAu3owOQXfZT.png alt=pwn_output></p><p>可以看到，在输入了超过10个字符后，<code>modified</code>的值被改变了。原因在于数据的存储方式。计算机中有一个叫内存空间的东西，它存放着所有的变量。一般情况下，一个变量将会分字节存在内存空间中，如左图所示。而<code>buffer[10]</code> 开辟了10个字节的内存空间，<code>modified</code>在<code>buffer[10]</code>上面开辟了4个字节的空间（通常<em>指x86</em>，数据是这么排列在计算机中的）。当我们输入了10个A以后，<code>buffer[10]</code>的内存空间被用完了，而gets()函数并不会对空间的边界进行检查，所以当第11个A输入了以后，A被挤到了<code>(int)modified</code>的内存空间，所以原本是0的<code>modified</code>不再是0（实际上modified的值 是 A的askll值 <code>65</code> ）所以gets非常不安全当然这是非常特殊的情况，因为我们一般用的是cin或者scanf甚至在VS中用的是更加安全的scanf_s。</p><p>同样的，cin的运作原理也可以这么解释：在输入回车之前，所有的输入都会存在一个缓冲区中，程序会根据分隔符或者变量类型来选择读入合适的数据。<code>ifstream</code> 同理。</p><p>这个程序是一个很简单的堆栈溢出的例子，我觉得它对理解 内存空间有一定帮助。</p><p><img src=https://upload.wikimedia.org/wikipedia/zh/9/95/Stack_Overflow_website_logo.png alt="Stack Overflow website logo.png"></p><p>说到这里，Stackoverflow 直译过来就是堆栈溢出 XD。</p><p>​</p><p>而在这个具体的例子中：内存空间（栈）是这样的：</p><p></p><p>可以看出，内存的排列顺序是自下而上的，或者说叫做<code>小端序</code>。将会有一个叫做栈指针的指针指向当前的内存并对内存进行操作。</p><p>有诗云：手持两把锟斤拷 口中疾呼烫烫烫 脚踏千朵屯屯屯 笑看万物锘锘锘</p><p>我们非常熟悉的“烫烫烫”只有在<a href=https://aka.ms/pill>Microsodt VC</a> 在的debug 模式下才会出现。 VC会把未使用的内存空间全部填入 <code>0xCC</code> ，比如在声明变量却没有赋值而且还调用的情况下。在中文的环境下，与askll码对于一个字节不同，中文字符对于两个字节。 而在GBK内码下（类似askll码 ， 将二进制数 转化为中文字符 ）， <code>0xCCCC</code> 对应的中文字符就是 <code>烫</code></p><p><img src=https://i.loli.net/2019/12/12/GFHbLwIEOVzgfBm.jpg alt=hot></p><h2 id=空の上の森の中の>空の上の森の中の</h2><p>所以编译器到底在干什么？</p><p>很多人都听说了C是一种高级语言，编译器把高级语言翻译成低级语言，操作系统把低级语言翻译成机器码。</p><p>那么我们可以看一看编译器翻译后的代码，来关注一下程序到底是什么运作的。</p><p>一般情况下，我们可以直接调用编译器来输出汇编代码，以<code>helloworld.c</code>为例。</p><p><img src=https://i.loli.net/2019/12/05/5kwmUpTeyH8K1tS.png alt=hello_c.png></p><p>打开终端，输入命令</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ gcc -S helloworld.c -Og -masm<span style=color:#f92672>=</span>intel
</code></pre></div><ul><li><p>gcc 代表使用的编译器， gcc编译C files, g++编译 Cpp files， 类似的还有clang 和 clang++)</p></li><li><p>-S 表示输出汇编程序 （-o表示生成可执行文件）</p></li><li><p>-Og是编译器的优化等级，让编译器不要做过多的优化，随着编译技术的提升，现在编译器几乎等于已经把你的程序重新写一遍了 （类似的还有 -O2 -O1)</p></li><li><p>-masm=intel 表示使用intel的语法，便于理解</p></li><li><p>当然可以用文末的在线工具（推荐）</p></li></ul><p>然后就可以得到汇编代码</p><p><img src=https://rvvaja.sn.files.1drv.com/y4m6Sc8XX8KQRONgboRxXeunGuo6tglDajkSL8QvEaZZEFVhUznxUWhoSY-JZss6XpXa2Ukd1mMrR_pg9JyEUOlQ-VIwDPpfENkqbU01JXogH8M3IDEbUOCjwaND9bVkmTDjLREUyKNVGKa6g2A8bePBL9R5b_FyNav3X6MiZJUyYIPKeHOk1rCJqeZrd95LGNldzYPl8mEur5MelCzZ21-BA alt=hello_s></p><p>简单的说，</p><table><thead><tr><th align=center>sub</th><th>在内存中开辟了一段空间【栈】 （注：这里的栈和数据解构的栈是不一样的）</th></tr></thead><tbody><tr><td align=center>lea</td><td><code>load effective address</code></td></tr><tr><td align=center>call</td><td>调用 <code>puts ( printf )</code> 输出了这段内存上所存的数据 ( 即helloworld )，，把<code>.LC0</code>地址放入<code>rdi</code> ，也就是<code>printf</code>的第一个参数。</td></tr><tr><td align=center>mov</td><td>将eax寄存器移到栈顶（0位）</td></tr><tr><td align=center>add</td><td>将add的第二个参数加到第一个参数上，在这里是rsp += 8</td></tr><tr><td align=center>ret</td><td>返回</td></tr></tbody></table><h2 id=帰らぬ者と待ち続けた者たち>帰らぬ者と、待ち続けた者たち</h2><p><img src=https://i.loli.net/2019/12/12/2XAuTIF6jzlPnZa.jpg alt=sheep></p><p>不知道各位在编程中有没有出现过这种事情（笑</p><p>正如前文所指出的，C并没有边界检查，C不是一门高精度语言，所以在做大数运算的时候会导致精度丢失，数据溢出等问题。比如上图所展示的那样。这是很奇特的性质，具体解释会在资料中给出。</p><p>int型最高位是符号位，所以当达到int的最大值的时候符号位由表示正数的0变为表示复数的1，并且由于用补码储存的缘故，得到了如图所示的输出。</p><p><img src=https://i.loli.net/2019/12/12/Wk943pwRhYS1C5D.png alt=int++></p><p>​ 有时候我们会在程序中用到很大的数字，比如算组合数的时候有些程序会使用阶乘来计算。当n过大的时候，有时候阶乘算出来就不怎么准确了。</p><p><img src=https://i.loli.net/2019/12/12/gSTYrXN6DyBkOCG.png alt=int></p><p><img src=https://i.loli.net/2019/12/12/Tlj1CAPnYhGumDd.png alt=int_output></p><p>当然，你可以用尽最大的数据类型，甚至舍弃符号位，用<code>unsigned long long</code> 的数据类型（也就是夸张的0 ~ 2^64 ，八字节），但是问题实际上并没有解决。</p><p><img src=https://i.loli.net/2019/12/12/JcU4ovVMS7rKN8L.png alt=unsigned_ll></p><p><img src=https://i.loli.net/2019/12/12/G46OH28FgJpkXWE.png alt=unsigned_ll_output></p><p>虽然我们可以确保20以内的阶乘的值是精确的（事实上<code>21!</code>就出现问题了，而且因为 <code>unsigned long long</code> 没有符号位的特性，和int不一样，它不是负数，而是看似正确的一个极大的正数）。但是在算组合数的依旧值得注意“<code>算术溢出</code>”的问题。</p><p>$$
C_{40}^{20} = \frac{40!}{20!20!}
$$
在运算过程中，编译器会自动进行数据类型转换，尽可能的存下这些数据，但是如果数据过大，仍然会产生溢出。</p><p>所以在写程序的时候应该适当的考虑一下内存和时间的边界问题。因为本质上计算机是在拿有限的空间去表示无限的数字。对于过大的数据，可以选择更加高明的算法来解决。组合数的算法有四种写法,你知道吗?</p><h2 id=ただいま帰りました>ただいま帰りました</h2><p>在Mid-Term中有这么一道题：</p><p></p><p>汇编结果是：</p><p></p><p>可以用动图解释：</p><p><img src=https://sfvjja.sn.files.1drv.com/y4mwZkZaitnGI4yA_6yDuXltwuwScPKWK-T6B8STVtHt4xV8SbRvbX3JWU6CmnXgUgyMKHg5BdP1nN1vl88ztDOADECEGLdgePcgEgk3bWSBaY_F_-IPc6pMxuPDnIJ5zXclHfDes4ieT19VcMMRTlva7U-w9bC9kGMb8kFgY65bR0-9zdD29mt66ZUS5nn7F5bCTdkWgQ85wqdU3FsVrDBew alt=union></p><h2 id=どうか忘れないで>どうか、忘れないで</h2><p>基于本文，可以给出一下优化程序的建议：</p><ul><li><p>关注数据类型和内存边界问题</p></li><li><p>由上文带来的算法优化问题，能否用算法来解决数据类型和内存大小的限制</p></li><li><p>其它内存相关的优化（比如考虑内存的连续性，考虑减少不必要的调用和引用）</p></li><li><p>etc</p></li></ul><h3 id=设计模式>设计模式</h3><ul><li><p>工厂模式</p><p>C++ 是 一门 OOP 语言， C++ 有多态，存在着继承关系的类。与现实类似，C++模式中的工厂通过一个工厂类，产生对应的子类。对于复杂的代码，比如之前的几次作业，可以方便我们理解。</p></li><li><p>原则</p><p>1 DONT REPEAT YOURSELF
2 MAKE THINGS AS LOCAL AS POSSIBLE</p></li></ul><h2 id=参考>参考</h2><ol><li><p><a href=https://stackoverflow.com/questions/48160580/why-2147483647-1-is-actually-2147483648>Why 2147483647 + 1 is actually -2147483648?</a></p></li><li><p><a href="https://www.youtube.com/watch?v=pOOivAJ63DM">Understanding the Stack</a></p></li><li><p><a href=https://godbolt.org/>汇编可视化</a></p></li><li><p><a href=https://zh.wikipedia.org/wiki/%E6%A0%88%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA>栈缓冲区溢出</a></p></li><li><p><a href=https://zh.wikipedia.org/wiki/%E5%AD%97%E8%8A%82%E5%BA%8F>字节序</a></p></li></ol><h2 id=感谢>感谢</h2><ul><li><a href=https://github.com/ShanghaitechGeekPie>Geekpie Association</a></li><li><a href=https://github.com/shinohara-rin>Rin</a></li><li><a href=https://github.com/Tsezz>Tsez</a></li><li><a href=https://www.chtholly.ac.cn/>中国珂学院</a></li></ul></div></article><div class=blog-post-comments><div id=disqus_thread><script type=text/javascript>(function(){var dsq=document.createElement('script');dsq.type='text/javascript';dsq.async=true;var disqus_shortname='canarypwn';dsq.src='//'+disqus_shortname+'.disqus.com/embed.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=/posts>Posts</a></li><li><a href=/tags>Tags</a></li><li><a href=/networks>Network</a></li><li><a href=/notes>Notes</a></li><li><a href=https://500px.com/p/nyovelt>Images</a></li><li><a href=/friends>Friends</a></li><li><a href=https://who.aaaab3n.moe/>About</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#太陽の傾いたこの世界で>太陽の傾いたこの世界で</a></li><li><a href=#この戦いが終わったら>この戦いが終わったら</a></li><li><a href=#空の上の森の中の>空の上の森の中の</a></li><li><a href=#帰らぬ者と待ち続けた者たち>帰らぬ者と、待ち続けた者たち</a></li><li><a href=#ただいま帰りました>ただいま帰りました</a></li><li><a href=#どうか忘れないで>どうか、忘れないで</a><ul><li><a href=#设计模式>设计模式</a></li></ul></li><li><a href=#参考>参考</a></li><li><a href=#感谢>感谢</a></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2faaaab3n.moe%2fposts%2f2019-11-29-c-cpp-black-magic%2f"><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2faaaab3n.moe%2fposts%2f2019-11-29-c-cpp-black-magic%2f&text=%e7%bc%96%e8%af%91%e6%97%b6%e4%bd%a0%e5%9c%a8%e5%81%9a%e4%bb%80%e4%b9%88%ef%bc%9f%e6%9c%89%e6%b2%a1%e6%9c%89%e7%a9%ba%ef%bc%9f%e5%8f%af%e4%bb%a5%e6%9d%a5%e6%8b%af%e6%95%91%e5%90%97%ef%bc%9f"><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2faaaab3n.moe%2fposts%2f2019-11-29-c-cpp-black-magic%2f&title=%e7%bc%96%e8%af%91%e6%97%b6%e4%bd%a0%e5%9c%a8%e5%81%9a%e4%bb%80%e4%b9%88%ef%bc%9f%e6%9c%89%e6%b2%a1%e6%9c%89%e7%a9%ba%ef%bc%9f%e5%8f%af%e4%bb%a5%e6%9d%a5%e6%8b%af%e6%95%91%e5%90%97%ef%bc%9f"><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2faaaab3n.moe%2fposts%2f2019-11-29-c-cpp-black-magic%2f&is_video=false&description=%e7%bc%96%e8%af%91%e6%97%b6%e4%bd%a0%e5%9c%a8%e5%81%9a%e4%bb%80%e4%b9%88%ef%bc%9f%e6%9c%89%e6%b2%a1%e6%9c%89%e7%a9%ba%ef%bc%9f%e5%8f%af%e4%bb%a5%e6%9d%a5%e6%8b%af%e6%95%91%e5%90%97%ef%bc%9f"><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=%e7%bc%96%e8%af%91%e6%97%b6%e4%bd%a0%e5%9c%a8%e5%81%9a%e4%bb%80%e4%b9%88%ef%bc%9f%e6%9c%89%e6%b2%a1%e6%9c%89%e7%a9%ba%ef%bc%9f%e5%8f%af%e4%bb%a5%e6%9d%a5%e6%8b%af%e6%95%91%e5%90%97%ef%bc%9f&body=Check out this article: https%3a%2f%2faaaab3n.moe%2fposts%2f2019-11-29-c-cpp-black-magic%2f"><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2faaaab3n.moe%2fposts%2f2019-11-29-c-cpp-black-magic%2f&title=%e7%bc%96%e8%af%91%e6%97%b6%e4%bd%a0%e5%9c%a8%e5%81%9a%e4%bb%80%e4%b9%88%ef%bc%9f%e6%9c%89%e6%b2%a1%e6%9c%89%e7%a9%ba%ef%bc%9f%e5%8f%af%e4%bb%a5%e6%9d%a5%e6%8b%af%e6%95%91%e5%90%97%ef%bc%9f"><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2faaaab3n.moe%2fposts%2f2019-11-29-c-cpp-black-magic%2f&title=%e7%bc%96%e8%af%91%e6%97%b6%e4%bd%a0%e5%9c%a8%e5%81%9a%e4%bb%80%e4%b9%88%ef%bc%9f%e6%9c%89%e6%b2%a1%e6%9c%89%e7%a9%ba%ef%bc%9f%e5%8f%af%e4%bb%a5%e6%9d%a5%e6%8b%af%e6%95%91%e5%90%97%ef%bc%9f"><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2faaaab3n.moe%2fposts%2f2019-11-29-c-cpp-black-magic%2f&name=%e7%bc%96%e8%af%91%e6%97%b6%e4%bd%a0%e5%9c%a8%e5%81%9a%e4%bb%80%e4%b9%88%ef%bc%9f%e6%9c%89%e6%b2%a1%e6%9c%89%e7%a9%ba%ef%bc%9f%e5%8f%af%e4%bb%a5%e6%9d%a5%e6%8b%af%e6%95%91%e5%90%97%ef%bc%9f&description=%e5%a4%aa%e9%99%bd%e3%81%ae%e5%82%be%e3%81%84%e3%81%9f%e3%81%93%e3%81%ae%e4%b8%96%e7%95%8c%e3%81%a7%20%e9%80%9a%e5%b8%b8%e5%86%99%e7%a8%8b%e5%ba%8f%e7%9a%84%e6%97%b6%e5%80%99%ef%bc%8c%e6%88%91%e4%bb%ac%e4%bc%9a%e6%9b%b4%e5%85%b3%e6%b3%a8%e4%ba%8e%e7%a8%8b%e5%ba%8f%e7%9a%84%e4%bb%a3%e7%a0%81%28main.c%29%e5%92%8c%e6%9c%80%e7%bb%88%e5%bd%a2%e6%88%90%e7%9a%84%e5%8f%af%e6%89%a7%e8%a1%8c%e6%96%87%e4%bb%b6%28main%29%e3%80%82%e5%af%b9%e4%ba%8e%e7%a8%8b%e5%ba%8f%e5%91%98%e6%9d%a5%e8%af%b4%ef%bc%8c%e8%bf%99%e4%b8%a4%e4%b8%aa%e9%83%a8%e5%88%86%e7%9a%84%e7%a1%ae%e6%98%af%e6%9c%80%e9%87%8d%e8%a6%81%e7%9a%84%ef%bc%8c%e7%94%9a%e8%87%b3%e8%af%b490%25%e7%9a%84%e6%83%85%e5%86%b5%e4%b8%8b%e9%83%bd%e4%b8%8d%e7%94%a8%e5%8e%bb%e7%ae%a1%e5%85%b6%e5%ae%83%e9%83%a8%e5%88%86%e3%80%82%e7%8e%b0%e4%bb%a3%e7%9a%84%e7%bc%96%e8%af%91%e5%99%a8%e9%9d%9e%e5%b8%b8%e6%99%ba%e8%83%bd%ef%bc%8c%e5%ae%83%e4%bb%ac%e4%bc%9a%e5%b8%ae%e4%bd%a0%e5%a4%84%e7%90%86%e5%a5%bd%e5%be%88%e5%a4%9a%e4%b8%9c%e8%a5%bf%ef%bc%88%e8%a1%a8%e6%89%ac%20clang%20%5bkl%c3%a6%c5%8b%5d%20%29%20%e3%80%82%e4%bd%86%e6%98%af%ef%bc%8c%e5%9c%a8%e7%bc%96%e8%af%91%e7%9a%84%e8%bf%87%e7%a8%8b%e4%b8%ad%ef%bc%8c%e9%99%a4%e4%ba%86%e4%bd%a0%e7%9a%84%e6%ba%90%e4%bb%a3%e7%a0%81%e5%92%8c%e6%9c%80%e7%bb%88%e7%9a%84%e5%8f%af%e6%89%a7%e8%a1%8c%e7%a8%8b%e5%ba%8f%ef%bc%8c%e5%85%b6%e5%ae%83%e9%83%a8%e5%88%86%ef%bc%8c%e4%b9%9f%e5%b0%b1%e6%98%af%e7%bc%96%e8%af%91%e5%99%a8%e5%81%9a%e7%9a%84%e9%82%a3%e9%83%a8%e5%88%86%ef%bc%8c%e4%b9%9f%e5%ba%94%e8%af%a5%e5%be%97%e5%88%b0%e5%85%b3%e6%b3%a8%e3%80%82%e6%89%80%e4%bb%a5%ef%bc%8c%e8%bf%99%e6%ac%a1%e7%9a%84workshop%e5%b0%86%e4%bc%9a%e5%85%b3%e6%b3%a8%e7%a8%8b%e5%ba%8f%e8%bf%90%e8%a1%8c%e8%83%8c%e5%90%8e%e7%9a%84%e6%95%85%e4%ba%8b%e3%80%82%e4%ba%8b%e5%ae%9e%e4%b8%8a%ef%bc%8c%e6%9c%89%e5%be%88%e5%a4%9abug%e6%98%af%e5%9b%a0%e4%b8%ba%e5%bf%bd%e8%a7%86%e4%ba%86%e7%bc%96%e8%af%91%e5%99%a8%e7%9a%84%e8%bf%90%e4%bd%9c%e5%8e%9f%e7%90%86%e8%80%8c%e5%af%bc%e8%87%b4%e7%9a%84%e3%80%82%0a%e7%8e%b0%e5%9c%a8%e6%88%91%e4%bb%ac%e5%ad%a6%e7%9a%84%e5%a4%a7%e9%83%a8%e5%88%86%e8%af%ad%e8%a8%80%e9%83%bd%e6%98%af%e9%ab%98%e7%ba%a7%e8%af%ad%e8%a8%80%ef%bc%8c%e8%80%8cCPU%e8%ae%a4%e7%9a%84%e5%8d%b4%e6%98%af%e4%ba%8c%e8%bf%9b%e5%88%b6%e7%9a%84%e6%9c%ba%e5%99%a8%e7%a0%81%e3%80%82%e5%bd%93%e6%88%91%e4%bb%ac%e5%9c%a8%e7%bc%96%e8%af%91%e7%a8%8b%e5%ba%8f%e7%9a%84%e6%97%b6%e5%80%99%ef%bc%8c%e7%bc%96%e8%af%91%e5%99%a8%e4%bc%9a%e5%b0%86%e6%88%91%e4%bb%ac%e7%9a%84%e9%ab%98%e7%ba%a7%e8%af%ad%e8%a8%80%e7%bf%bb%e8%af%91%e6%88%90%e4%bd%8e%e7%ba%a7%e7%9a%84%e6%b1%87%e7%bc%96%e8%af%ad%e8%a8%80%e3%80%82%e8%80%8c%e5%9c%a8%e7%a8%8b%e5%ba%8f%e8%bf%90%e8%a1%8c%e7%9a%84%e6%97%b6%e5%80%99%ef%bc%8c%e4%bc%9a%e5%b0%86%e6%b1%87%e7%bc%96%e8%af%ad%e8%a8%80%e7%bf%bb%e8%af%91%e6%88%90%e6%9c%ba%e5%99%a8%e7%a0%81%e3%80%82%e8%bf%99%e6%98%af%e7%a8%8b%e5%ba%8f%e7%9a%84%e8%bf%90%e4%bd%9c%e5%8e%9f%e7%90%86%e3%80%82%0a%e3%81%93%e3%81%ae%e6%88%a6%e3%81%84%e3%81%8c%e7%b5%82%e3%82%8f%e3%81%a3%e3%81%9f%e3%82%89%20C%e4%bd%9c%e4%b8%ba%e4%b8%80%e9%97%a8%e4%b8%8d%e4%bc%9a%e5%af%b9%e5%86%85%e5%ad%98%e6%a3%80%e6%9f%a5%e7%9a%84%e8%af%ad%e8%a8%80%ef%bc%8c%e5%9b%a0%e6%ad%a4%e5%be%88%e5%a4%9a%e7%9a%84%e6%93%8d%e4%bd%9c%e4%bc%9a%e8%b6%85%e5%87%ba%e4%b8%80%e4%b8%aa%e5%8f%98%e9%87%8f%e7%9a%84%e8%be%b9%e7%95%8c%e5%8e%bb%e5%bd%b1%e5%93%8d%e4%b8%8b%e4%b8%80%e4%b8%aa%e5%8f%98%e9%87%8f%ef%bc%8c%e4%b8%be%e4%b8%80%e4%b8%aa%e4%be%8b%e5%ad%90%ef%bc%9a%0a%e6%9c%89%e6%b2%a1%e6%9c%89%e4%bb%80%e4%b9%88%e5%8a%9e%e6%b3%95%e6%9d%a5%e6%94%b9%e5%8f%98%e5%8f%98%e9%87%8fmodified%e7%9a%84%e5%80%bc%e5%91%a2%ef%bc%9f%0a%e5%8f%af%e4%bb%a5%e5%90%8c%e6%97%b6%e8%be%93%e5%85%a510%e4%b8%aaA%20%e5%92%8c11%e4%b8%aaA%20%e6%9d%a5%e5%ba%b7%e5%ba%b7%e7%bb%93%e6%9e%9c%ef%bc%9a%0a%e5%8f%af%e4%bb%a5%e7%9c%8b%e5%88%b0%ef%bc%8c%e5%9c%a8%e8%be%93%e5%85%a5%e4%ba%86%e8%b6%85%e8%bf%8710%e4%b8%aa%e5%ad%97%e7%ac%a6%e5%90%8e%ef%bc%8cmodified%e7%9a%84%e5%80%bc%e8%a2%ab%e6%94%b9%e5%8f%98%e4%ba%86%e3%80%82%e5%8e%9f%e5%9b%a0%e5%9c%a8%e4%ba%8e%e6%95%b0%e6%8d%ae%e7%9a%84%e5%ad%98%e5%82%a8%e6%96%b9%e5%bc%8f%e3%80%82%e8%ae%a1%e7%ae%97%e6%9c%ba%e4%b8%ad%e6%9c%89%e4%b8%80%e4%b8%aa%e5%8f%ab%e5%86%85%e5%ad%98%e7%a9%ba%e9%97%b4%e7%9a%84%e4%b8%9c%e8%a5%bf%ef%bc%8c%e5%ae%83%e5%ad%98%e6%94%be%e7%9d%80%e6%89%80%e6%9c%89%e7%9a%84%e5%8f%98%e9%87%8f%e3%80%82%e4%b8%80%e8%88%ac%e6%83%85%e5%86%b5%e4%b8%8b%ef%bc%8c%e4%b8%80%e4%b8%aa%e5%8f%98%e9%87%8f%e5%b0%86%e4%bc%9a%e5%88%86%e5%ad%97%e8%8a%82%e5%ad%98%e5%9c%a8%e5%86%85%e5%ad%98%e7%a9%ba%e9%97%b4%e4%b8%ad%ef%bc%8c%e5%a6%82%e5%b7%a6%e5%9b%be%e6%89%80%e7%a4%ba%e3%80%82%e8%80%8cbuffer%5b10%5d%20%e5%bc%80%e8%be%9f%e4%ba%8610%e4%b8%aa%e5%ad%97%e8%8a%82%e7%9a%84%e5%86%85%e5%ad%98%e7%a9%ba%e9%97%b4%ef%bc%8cmodified%e5%9c%a8buffer%5b10%5d%e4%b8%8a%e9%9d%a2%e5%bc%80%e8%be%9f%e4%ba%864%e4%b8%aa%e5%ad%97%e8%8a%82%e7%9a%84%e7%a9%ba%e9%97%b4%ef%bc%88%e9%80%9a%e5%b8%b8%e6%8c%87x86%ef%bc%8c%e6%95%b0%e6%8d%ae%e6%98%af%e8%bf%99%e4%b9%88%e6%8e%92%e5%88%97%e5%9c%a8%e8%ae%a1%e7%ae%97%e6%9c%ba%e4%b8%ad%e7%9a%84%ef%bc%89%e3%80%82%e5%bd%93%e6%88%91%e4%bb%ac%e8%be%93%e5%85%a5%e4%ba%8610%e4%b8%aaA%e4%bb%a5%e5%90%8e%ef%bc%8cbuffer%5b10%5d%e7%9a%84%e5%86%85%e5%ad%98%e7%a9%ba%e9%97%b4%e8%a2%ab%e7%94%a8%e5%ae%8c%e4%ba%86%ef%bc%8c%e8%80%8cgets%28%29%e5%87%bd%e6%95%b0%e5%b9%b6%e4%b8%8d%e4%bc%9a%e5%af%b9%e7%a9%ba%e9%97%b4%e7%9a%84%e8%be%b9%e7%95%8c%e8%bf%9b%e8%a1%8c%e6%a3%80%e6%9f%a5%ef%bc%8c%e6%89%80%e4%bb%a5%e5%bd%93%e7%ac%ac11%e4%b8%aaA%e8%be%93%e5%85%a5%e4%ba%86%e4%bb%a5%e5%90%8e%ef%bc%8cA%e8%a2%ab%e6%8c%a4%e5%88%b0%e4%ba%86%28int%29modified%e7%9a%84%e5%86%85%e5%ad%98%e7%a9%ba%e9%97%b4%ef%bc%8c%e6%89%80%e4%bb%a5%e5%8e%9f%e6%9c%ac%e6%98%af0%e7%9a%84modified%e4%b8%8d%e5%86%8d%e6%98%af0%ef%bc%88%e5%ae%9e%e9%99%85%e4%b8%8amodified%e7%9a%84%e5%80%bc%20%e6%98%af%20A%e7%9a%84askll%e5%80%bc%2065%20%ef%bc%89%e6%89%80%e4%bb%a5gets%e9%9d%9e%e5%b8%b8%e4%b8%8d%e5%ae%89%e5%85%a8%e5%bd%93%e7%84%b6%e8%bf%99%e6%98%af%e9%9d%9e%e5%b8%b8%e7%89%b9%e6%ae%8a%e7%9a%84%e6%83%85%e5%86%b5%ef%bc%8c%e5%9b%a0%e4%b8%ba%e6%88%91%e4%bb%ac%e4%b8%80%e8%88%ac%e7%94%a8%e7%9a%84%e6%98%afcin%e6%88%96%e8%80%85scanf%e7%94%9a%e8%87%b3%e5%9c%a8VS%e4%b8%ad%e7%94%a8%e7%9a%84%e6%98%af%e6%9b%b4%e5%8a%a0%e5%ae%89%e5%85%a8%e7%9a%84scanf_s%e3%80%82%0a%e5%90%8c%e6%a0%b7%e7%9a%84%ef%bc%8ccin%e7%9a%84%e8%bf%90%e4%bd%9c%e5%8e%9f%e7%90%86%e4%b9%9f%e5%8f%af%e4%bb%a5%e8%bf%99%e4%b9%88%e8%a7%a3%e9%87%8a%ef%bc%9a%e5%9c%a8%e8%be%93%e5%85%a5%e5%9b%9e%e8%bd%a6%e4%b9%8b%e5%89%8d%ef%bc%8c%e6%89%80%e6%9c%89%e7%9a%84%e8%be%93%e5%85%a5%e9%83%bd%e4%bc%9a%e5%ad%98%e5%9c%a8%e4%b8%80%e4%b8%aa%e7%bc%93%e5%86%b2%e5%8c%ba%e4%b8%ad%ef%bc%8c%e7%a8%8b%e5%ba%8f%e4%bc%9a%e6%a0%b9%e6%8d%ae%e5%88%86%e9%9a%94%e7%ac%a6%e6%88%96%e8%80%85%e5%8f%98%e9%87%8f%e7%b1%bb%e5%9e%8b%e6%9d%a5%e9%80%89%e6%8b%a9%e8%af%bb%e5%85%a5%e5%90%88%e9%80%82%e7%9a%84%e6%95%b0%e6%8d%ae%e3%80%82ifstream%20%e5%90%8c%e7%90%86%e3%80%82%0a%e8%bf%99%e4%b8%aa%e7%a8%8b%e5%ba%8f%e6%98%af%e4%b8%80%e4%b8%aa%e5%be%88%e7%ae%80%e5%8d%95%e7%9a%84%e5%a0%86%e6%a0%88%e6%ba%a2%e5%87%ba%e7%9a%84%e4%be%8b%e5%ad%90%ef%bc%8c%e6%88%91%e8%a7%89%e5%be%97%e5%ae%83%e5%af%b9%e7%90%86%e8%a7%a3%20%e5%86%85%e5%ad%98%e7%a9%ba%e9%97%b4%e6%9c%89%e4%b8%80%e5%ae%9a%e5%b8%ae%e5%8a%a9%e3%80%82%0a%e8%af%b4%e5%88%b0%e8%bf%99%e9%87%8c%ef%bc%8cStackoverflow%20%e7%9b%b4%e8%af%91%e8%bf%87%e6%9d%a5%e5%b0%b1%e6%98%af%e5%a0%86%e6%a0%88%e6%ba%a2%e5%87%ba%20XD%e3%80%82%0a%e2%80%8b%09%e8%80%8c%e5%9c%a8%e8%bf%99%e4%b8%aa%e5%85%b7%e4%bd%93%e7%9a%84%e4%be%8b%e5%ad%90%e4%b8%ad%ef%bc%9a%e5%86%85%e5%ad%98%e7%a9%ba%e9%97%b4%ef%bc%88%e6%a0%88%ef%bc%89%e6%98%af%e8%bf%99%e6%a0%b7%e7%9a%84%ef%bc%9a%0a%e5%8f%af%e4%bb%a5%e7%9c%8b%e5%87%ba%ef%bc%8c%e5%86%85%e5%ad%98%e7%9a%84%e6%8e%92%e5%88%97%e9%a1%ba%e5%ba%8f%e6%98%af%e8%87%aa%e4%b8%8b%e8%80%8c%e4%b8%8a%e7%9a%84%ef%bc%8c%e6%88%96%e8%80%85%e8%af%b4%e5%8f%ab%e5%81%9a%e5%b0%8f%e7%ab%af%e5%ba%8f%e3%80%82%e5%b0%86%e4%bc%9a%e6%9c%89%e4%b8%80%e4%b8%aa%e5%8f%ab%e5%81%9a%e6%a0%88%e6%8c%87%e9%92%88%e7%9a%84%e6%8c%87%e9%92%88%e6%8c%87%e5%90%91%e5%bd%93%e5%89%8d%e7%9a%84%e5%86%85%e5%ad%98%e5%b9%b6%e5%af%b9%e5%86%85%e5%ad%98%e8%bf%9b%e8%a1%8c%e6%93%8d%e4%bd%9c%e3%80%82%0a%e6%9c%89%e8%af%97%e4%ba%91%ef%bc%9a%e6%89%8b%e6%8c%81%e4%b8%a4%e6%8a%8a%e9%94%9f%e6%96%a4%e6%8b%b7%20%e5%8f%a3%e4%b8%ad%e7%96%be%e5%91%bc%e7%83%ab%e7%83%ab%e7%83%ab%20%e8%84%9a%e8%b8%8f%e5%8d%83%e6%9c%b5%e5%b1%af%e5%b1%af%e5%b1%af%20%e7%ac%91%e7%9c%8b%e4%b8%87%e7%89%a9%e9%94%98%e9%94%98%e9%94%98%0a%e6%88%91%e4%bb%ac%e9%9d%9e%e5%b8%b8%e7%86%9f%e6%82%89%e7%9a%84%e2%80%9c%e7%83%ab%e7%83%ab%e7%83%ab%e2%80%9d%e5%8f%aa%e6%9c%89%e5%9c%a8Microsodt%20VC%20%e5%9c%a8%e7%9a%84debug%20%e6%a8%a1%e5%bc%8f%e4%b8%8b%e6%89%8d%e4%bc%9a%e5%87%ba%e7%8e%b0%e3%80%82%20VC%e4%bc%9a%e6%8a%8a%e6%9c%aa%e4%bd%bf%e7%94%a8%e7%9a%84%e5%86%85%e5%ad%98%e7%a9%ba%e9%97%b4%e5%85%a8%e9%83%a8%e5%a1%ab%e5%85%a5%200xCC%20%ef%bc%8c%e6%af%94%e5%a6%82%e5%9c%a8%e5%a3%b0%e6%98%8e%e5%8f%98%e9%87%8f%e5%8d%b4%e6%b2%a1%e6%9c%89%e8%b5%8b%e5%80%bc%e8%80%8c%e4%b8%94%e8%bf%98%e8%b0%83%e7%94%a8%e7%9a%84%e6%83%85%e5%86%b5%e4%b8%8b%e3%80%82%e5%9c%a8%e4%b8%ad%e6%96%87%e7%9a%84%e7%8e%af%e5%a2%83%e4%b8%8b%ef%bc%8c%e4%b8%8easkll%e7%a0%81%e5%af%b9%e4%ba%8e%e4%b8%80%e4%b8%aa%e5%ad%97%e8%8a%82%e4%b8%8d%e5%90%8c%ef%bc%8c%e4%b8%ad%e6%96%87%e5%ad%97%e7%ac%a6%e5%af%b9%e4%ba%8e%e4%b8%a4%e4%b8%aa%e5%ad%97%e8%8a%82%e3%80%82%20%e8%80%8c%e5%9c%a8GBK%e5%86%85%e7%a0%81%e4%b8%8b%ef%bc%88%e7%b1%bb%e4%bc%bcaskll%e7%a0%81%20%ef%bc%8c%20%e5%b0%86%e4%ba%8c%e8%bf%9b%e5%88%b6%e6%95%b0%20%e8%bd%ac%e5%8c%96%e4%b8%ba%e4%b8%ad%e6%96%87%e5%ad%97%e7%ac%a6%20%ef%bc%89%ef%bc%8c%200xCCCC%20%e5%af%b9%e5%ba%94%e7%9a%84%e4%b8%ad%e6%96%87%e5%ad%97%e7%ac%a6%e5%b0%b1%e6%98%af%20%e7%83%ab%0a%e7%a9%ba%e3%81%ae%e4%b8%8a%e3%81%ae%e6%a3%ae%e3%81%ae%e4%b8%ad%e3%81%ae%20%e6%89%80%e4%bb%a5%e7%bc%96%e8%af%91%e5%99%a8%e5%88%b0%e5%ba%95%e5%9c%a8%e5%b9%b2%e4%bb%80%e4%b9%88%ef%bc%9f%0a%e5%be%88%e5%a4%9a%e4%ba%ba%e9%83%bd%e5%90%ac%e8%af%b4%e4%ba%86C%e6%98%af%e4%b8%80%e7%a7%8d%e9%ab%98%e7%ba%a7%e8%af%ad%e8%a8%80%ef%bc%8c%e7%bc%96%e8%af%91%e5%99%a8%e6%8a%8a%e9%ab%98%e7%ba%a7%e8%af%ad%e8%a8%80%e7%bf%bb%e8%af%91%e6%88%90%e4%bd%8e%e7%ba%a7%e8%af%ad%e8%a8%80%ef%bc%8c%e6%93%8d%e4%bd%9c%e7%b3%bb%e7%bb%9f%e6%8a%8a%e4%bd%8e%e7%ba%a7%e8%af%ad%e8%a8%80%e7%bf%bb%e8%af%91%e6%88%90%e6%9c%ba%e5%99%a8%e7%a0%81%e3%80%82%0a%e9%82%a3%e4%b9%88%e6%88%91%e4%bb%ac%e5%8f%af%e4%bb%a5%e7%9c%8b%e4%b8%80%e7%9c%8b%e7%bc%96%e8%af%91%e5%99%a8%e7%bf%bb%e8%af%91%e5%90%8e%e7%9a%84%e4%bb%a3%e7%a0%81%ef%bc%8c%e6%9d%a5%e5%85%b3%e6%b3%a8%e4%b8%80%e4%b8%8b%e7%a8%8b%e5%ba%8f%e5%88%b0%e5%ba%95%e6%98%af%e4%bb%80%e4%b9%88%e8%bf%90%e4%bd%9c%e7%9a%84%e3%80%82%0a%e4%b8%80%e8%88%ac%e6%83%85%e5%86%b5%e4%b8%8b%ef%bc%8c%e6%88%91%e4%bb%ac%e5%8f%af%e4%bb%a5%e7%9b%b4%e6%8e%a5%e8%b0%83%e7%94%a8%e7%bc%96%e8%af%91%e5%99%a8%e6%9d%a5%e8%be%93%e5%87%ba%e6%b1%87%e7%bc%96%e4%bb%a3%e7%a0%81%ef%bc%8c%e4%bb%a5helloworld.c%e4%b8%ba%e4%be%8b%e3%80%82%0a%e6%89%93%e5%bc%80%e7%bb%88%e7%ab%af%ef%bc%8c%e8%be%93%e5%85%a5%e5%91%bd%e4%bb%a4%0a%24%20gcc%20-S%20helloworld.c%20-Og%20-masm%3dintel%20%20%20gcc%20%e4%bb%a3%e8%a1%a8%e4%bd%bf%e7%94%a8%e7%9a%84%e7%bc%96%e8%af%91%e5%99%a8%ef%bc%8c%20gcc%e7%bc%96%e8%af%91C%20files%2c%20g%2b%2b%e7%bc%96%e8%af%91%20Cpp%20files%ef%bc%8c%20%e7%b1%bb%e4%bc%bc%e7%9a%84%e8%bf%98%e6%9c%89clang%20%e5%92%8c%20clang%2b%2b%29"><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2faaaab3n.moe%2fposts%2f2019-11-29-c-cpp-black-magic%2f&t=%e7%bc%96%e8%af%91%e6%97%b6%e4%bd%a0%e5%9c%a8%e5%81%9a%e4%bb%80%e4%b9%88%ef%bc%9f%e6%9c%89%e6%b2%a1%e6%9c%89%e7%a9%ba%ef%bc%9f%e5%8f%af%e4%bb%a5%e6%9d%a5%e6%8b%af%e6%95%91%e5%90%97%ef%bc%9f"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu class=icon href=# onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden=true></i>Menu</a>
<a id=toc class=icon href=# onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden=true></i>TOC</a>
<a id=share class=icon href=# onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden=true></i>share</a>
<a id=top style=display:none class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i>Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2023 canarypwn</div><div class=footer-right><nav><ul><li><a href=/>Home</a></li><li><a href=/posts>Posts</a></li><li><a href=/tags>Tags</a></li><li><a href=/networks>Network</a></li><li><a href=/notes>Notes</a></li><li><a href=https://500px.com/p/nyovelt>Images</a></li><li><a href=/friends>Friends</a></li><li><a href=https://who.aaaab3n.moe/>About</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script><script src=/js/main.js></script></html>