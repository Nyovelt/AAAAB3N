<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>RSA 与 算法 | canarypwn</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="RSA 与 算法"><meta property="og:description" content="What is RSA  RSA 包含了 密钥（公钥，私钥）生成， 加密， 和解密。  How is RSA RSA 的计算过程:
  首先取两个互素的整数: m, N。
 m即要加密的信息 其中 m < N 也可以理解为先找到一个正整数N, 让任意的m<N使m,N互素。  其中，互素指最大公约数为1，即gcd(m,N) = 1。   这也是RSA算法的真正过程    N的取法: N = pq, (p,q are prime numbers)
 N 是凑出来的，为两个素数的积    这时引入欧拉函数: $$ \phi (n) = \mid \mathbb{Z}_n^* \mid $$
 构造函数$\phi(n)$表示小于等于 和 互质的数的个数 当 $n=pq$ 时， $\phi(n) = (p-1)(q-1)$  举例："><meta property="og:type" content="article"><meta property="og:url" content="https://aaaab3n.moe/posts/2020-4-15-rsa/"><meta property="article:published_time" content="2020-04-15T09:00:59+08:00"><meta property="article:modified_time" content="2020-04-15T09:00:59+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="RSA 与 算法"><meta name=twitter:description content="What is RSA  RSA 包含了 密钥（公钥，私钥）生成， 加密， 和解密。  How is RSA RSA 的计算过程:
  首先取两个互素的整数: m, N。
 m即要加密的信息 其中 m < N 也可以理解为先找到一个正整数N, 让任意的m<N使m,N互素。  其中，互素指最大公约数为1，即gcd(m,N) = 1。   这也是RSA算法的真正过程    N的取法: N = pq, (p,q are prime numbers)
 N 是凑出来的，为两个素数的积    这时引入欧拉函数: $$ \phi (n) = \mid \mathbb{Z}_n^* \mid $$
 构造函数$\phi(n)$表示小于等于 和 互质的数的个数 当 $n=pq$ 时， $\phi(n) = (p-1)(q-1)$  举例："><link rel=stylesheet href=https://aaaab3n.moe/css/style-white.css><link href="http://fonts.loli.net/css?family=Roboto" rel=stylesheet type=text/css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://aaaab3n.moe/images/favicon.ico><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','G-73VZSQL8QT','auto');ga('send','pageview');}</script></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a><a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a><a id=top-icon-tablet href=# onclick="$('html, body').animate({scrollTop:0},'fast');" style=display:none><i class="fas fa-chevron-up fa-lg"></i></a><span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=/posts>Posts</a></li><li><a href=/tags>Tags</a></li><li><a href=/networks>Network</a></li><li><a href=/notes>Notes</a></li><li><a href=https://500px.com/p/nyovelt>Images</a></li><li><a href=/friends>Friends</a></li><li><a href=https://who.aaaab3n.moe/>About</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://aaaab3n.moe/posts/2020-4-17-computer-science/><i class="fas fa-chevron-left" aria-hidden=true onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li><li><a class=icon href=https://aaaab3n.moe/posts/2020-4-19-an-reply/><i class="fas fa-chevron-right" aria-hidden=true onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li><li><a class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast');"><i class="fas fa-chevron-up" aria-hidden=true onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li><li><a class=icon href=#><i class="fas fa-share-alt" aria-hidden=true onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2faaaab3n.moe%2fposts%2f2020-4-15-rsa%2f"><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2faaaab3n.moe%2fposts%2f2020-4-15-rsa%2f&text=RSA%20%e4%b8%8e%20%e7%ae%97%e6%b3%95"><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2faaaab3n.moe%2fposts%2f2020-4-15-rsa%2f&title=RSA%20%e4%b8%8e%20%e7%ae%97%e6%b3%95"><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2faaaab3n.moe%2fposts%2f2020-4-15-rsa%2f&is_video=false&description=RSA%20%e4%b8%8e%20%e7%ae%97%e6%b3%95"><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=RSA%20%e4%b8%8e%20%e7%ae%97%e6%b3%95&body=Check out this article: https%3a%2f%2faaaab3n.moe%2fposts%2f2020-4-15-rsa%2f"><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2faaaab3n.moe%2fposts%2f2020-4-15-rsa%2f&title=RSA%20%e4%b8%8e%20%e7%ae%97%e6%b3%95"><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2faaaab3n.moe%2fposts%2f2020-4-15-rsa%2f&title=RSA%20%e4%b8%8e%20%e7%ae%97%e6%b3%95"><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2faaaab3n.moe%2fposts%2f2020-4-15-rsa%2f&name=RSA%20%e4%b8%8e%20%e7%ae%97%e6%b3%95&description=What%20is%20RSA%20%20RSA%20%e5%8c%85%e5%90%ab%e4%ba%86%20%e5%af%86%e9%92%a5%ef%bc%88%e5%85%ac%e9%92%a5%ef%bc%8c%e7%a7%81%e9%92%a5%ef%bc%89%e7%94%9f%e6%88%90%ef%bc%8c%20%e5%8a%a0%e5%af%86%ef%bc%8c%20%e5%92%8c%e8%a7%a3%e5%af%86%e3%80%82%20%20How%20is%20RSA%20RSA%20%e7%9a%84%e8%ae%a1%e7%ae%97%e8%bf%87%e7%a8%8b%3a%0a%20%20%e9%a6%96%e5%85%88%e5%8f%96%e4%b8%a4%e4%b8%aa%e4%ba%92%e7%b4%a0%e7%9a%84%e6%95%b4%e6%95%b0%3a%20m%2c%20N%e3%80%82%0a%20m%e5%8d%b3%e8%a6%81%e5%8a%a0%e5%af%86%e7%9a%84%e4%bf%a1%e6%81%af%20%e5%85%b6%e4%b8%ad%20m%20%26lt%3b%20N%20%e4%b9%9f%e5%8f%af%e4%bb%a5%e7%90%86%e8%a7%a3%e4%b8%ba%e5%85%88%e6%89%be%e5%88%b0%e4%b8%80%e4%b8%aa%e6%ad%a3%e6%95%b4%e6%95%b0N%2c%20%e8%ae%a9%e4%bb%bb%e6%84%8f%e7%9a%84m%26lt%3bN%e4%bd%bfm%2cN%e4%ba%92%e7%b4%a0%e3%80%82%20%20%e5%85%b6%e4%b8%ad%ef%bc%8c%e4%ba%92%e7%b4%a0%e6%8c%87%e6%9c%80%e5%a4%a7%e5%85%ac%e7%ba%a6%e6%95%b0%e4%b8%ba1%ef%bc%8c%e5%8d%b3gcd%28m%2cN%29%20%3d%201%e3%80%82%20%20%20%e8%bf%99%e4%b9%9f%e6%98%afRSA%e7%ae%97%e6%b3%95%e7%9a%84%e7%9c%9f%e6%ad%a3%e8%bf%87%e7%a8%8b%20%20%20%20N%e7%9a%84%e5%8f%96%e6%b3%95%3a%20N%20%3d%20pq%2c%20%28p%2cq%20are%20prime%20numbers%29%0a%20N%20%e6%98%af%e5%87%91%e5%87%ba%e6%9d%a5%e7%9a%84%ef%bc%8c%e4%b8%ba%e4%b8%a4%e4%b8%aa%e7%b4%a0%e6%95%b0%e7%9a%84%e7%a7%af%20%20%20%20%e8%bf%99%e6%97%b6%e5%bc%95%e5%85%a5%e6%ac%a7%e6%8b%89%e5%87%bd%e6%95%b0%3a%20%24%24%20%5cphi%20%28n%29%20%3d%20%5cmid%20%5cmathbb%7bZ%7d_n%5e%2a%20%5cmid%20%24%24%0a%20%e6%9e%84%e9%80%a0%e5%87%bd%e6%95%b0%24%5cphi%28n%29%24%e8%a1%a8%e7%a4%ba%e5%b0%8f%e4%ba%8e%e7%ad%89%e4%ba%8e%20%e5%92%8c%20%e4%ba%92%e8%b4%a8%e7%9a%84%e6%95%b0%e7%9a%84%e4%b8%aa%e6%95%b0%20%e5%bd%93%20%24n%3dpq%24%20%e6%97%b6%ef%bc%8c%20%24%5cphi%28n%29%20%3d%20%28p-1%29%28q-1%29%24%20%20%e4%b8%be%e4%be%8b%ef%bc%9a"><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2faaaab3n.moe%2fposts%2f2020-4-15-rsa%2f&t=RSA%20%e4%b8%8e%20%e7%ae%97%e6%b3%95"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#what-is-rsa>What is RSA</a></li><li><a href=#how-is-rsa>How is RSA</a></li><li><a href=#private-key-and-public-key>Private Key and Public Key</a></li><li><a href=#加密解密过程>加密解密过程</a></li><li><a href=#简单的证明>简单的证明</a></li><li><a href=#安全性>安全性</a></li><li><a href=#gcd>gcd()</a></li><li><a href=#快速取模>快速取模</a></li><li><a href=#乘法逆元>乘法逆元</a><ul><li><a href=#快速幂法>快速幂法</a></li><li><a href=#扩展欧几里得法>扩展欧几里得法</a></li></ul></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">RSA 与 算法</h1><div class=meta><div class=postdate><time datetime="2020-04-15 09:00:59 +0800 +0800" itemprop=datePublished>2020-04-15</time></div></div></header><div class=content itemprop=articleBody><h2 id=what-is-rsa>What is RSA</h2><p><img src="https://shqb6w.sn.files.1drv.com/y4mtCzO2Ua0b6P5OpXWH54cMbcAGihKdXR0_Ob_TItYp4hFKj9Jwyguso5nEon5CBdrqni4kiy2d2JBNjt0peFP_-NJ5JeUALgCuBFGV15_ppYH2PuE5tdiW323znhvOkYaQy2iHoTRkFjI0tVYhGE-ZSGDRQCu_rBg0V3_phjGiXQfxf6ZZlbekVkR2ZFeRCNzBUliw_j5Njv0O-v5KOfLNA?width=3844&height=2884&cropmode=none" alt=RSA></p><ul><li>RSA 包含了 密钥（公钥，私钥）生成， 加密， 和解密。</li></ul><h2 id=how-is-rsa>How is RSA</h2><p><img src="https://shqd6w.sn.files.1drv.com/y4mG6nC0p6lZSN6FGrqqR6lllJGiPPn_YZWuCRK6L9hngjbpZ-i1Bvn3kzhYOBrNDUC2RIRBtQkOp1ptoctD1D9a4UkZRTRuHETwRmpJJQMlikOiVZbvrBQZxP_pszLsVQBU7-XA95fc_bZEj6Fl60tFK9WqBzLC3HAUphFWniCS3fNmeAQHNBycAC32JgLlkjyVJcIDo3gsroHv_kuKaFv-w?width=3844&height=2884&cropmode=none" alt=RSA></p><p>RSA 的计算过程:</p><ul><li><p>首先取两个互素的整数: m, N。</p><ul><li>m即要加密的信息</li><li>其中 m &lt; N</li><li>也可以理解为先找到一个正整数N, 让任意的m&lt;N使m,N互素。<ul><li>其中，互素指最大公约数为1，即gcd(m,N) = 1。</li></ul></li><li>这也是RSA算法的真正过程</li></ul></li><li><p>N的取法: N = pq, (p,q are prime numbers)</p><ul><li>N 是凑出来的，为两个素数的积</li></ul></li></ul><p>这时引入<strong>欧拉函数</strong>:
$$
\phi (n) = \mid \mathbb{Z}_n^* \mid
$$</p><ul><li>构造函数$\phi(n)$表示小于等于 和 互质的数的个数</li><li>当 $n=pq$ 时， $\phi(n) = (p-1)(q-1)$</li></ul><p>举例：</p><ul><li>任意取两个素数p=7,q=13</li><li>此时N=pq=91</li><li>此时$\phi(n) = (p-1)(q-1)=6 \times 12 = 72$</li></ul><h2 id=private-key-and-public-key>Private Key and Public Key</h2><p>Public Key = (N, e)</p><p>Private Key = (N, d)</p><p>where,</p><ul><li>e是在$\mathbb{Z}_{\phi(n)}^*$中均匀分布的，随机的取一个数字</li><li>比如在之前的条件中，e为$\mathbb{Z}_\psi(91)^* =\mathbb{Z}_{72}^* = {1,3,5,7,\dots,71}$中随意的数字，例如 5</li><li>$\mathbb{Z}_n^*$表示小于n且与n互素的数</li><li>（N和e）即 (91，5) 组成了公钥</li><li>而私钥d的计算是 $e^{-1} = d$，即e的逆元<ul><li>乘法逆元: $e e^{-1} \bmod \psi(n) = 1$, $e^{-1}$即逆元</li><li>对于 $\psi(91) = 72$的情况，e=5, $e^{-1} = 29$</li><li>所以$d = e^{-1} = 29$</li></ul></li></ul><p>所以，我们可以这么表示RSA：</p><ul><li><p>公钥: (pq, $\mathbb{Z}_{\psi(pq)}$中的任何一个数字e)</p></li><li><p>私钥: (pq, $e^{-1}$)</p></li><li><p>p,q 为任意素数</p></li><li><p>在这里需要计算的有:</p><ul><li>$\mathbb{Z}_{\psi(pq)}$中的任何一个数字e<ul><li>即小于 $\mathbb{Z}_{\psi(pq)}$ 且与之gcd()=1的数字</li><li>即<strong>gcd()的算法</strong></li></ul></li><li>$e^{-1}$<ul><li>即<strong>求乘法逆元</strong></li></ul></li></ul></li></ul><h2 id=加密解密过程>加密解密过程</h2><p>对于任意的信息m:</p><ul><li><p>公钥: (pq, $\mathbb{Z}_{\psi(pq)}$中的任何一个数字e) = (N,e)</p></li><li><p>私钥: (pq, $e^{-1}$)</p></li><li><p>密文 = $m^e \bmod N$</p></li><li><p>明文 = $密文^{e^{-1}} \bmod N$</p></li></ul><p>举例:</p><ul><li>要加密的信息m=2</li><li>生成素数 p =7 q=13</li><li>得出 N=pq = 91</li><li>得出 e $\in$ $\mathbb{Z}<em>{\psi(N)}^*$ = $\mathbb{Z}</em>{72}^*$ = {1,2,3, &mldr; ,71}<ul><li>$\psi(N)$ = (p-1)(q-1) = 72</li><li>e 要和 72 互素</li><li>假设e取5</li></ul></li><li>密文 = $2^5 \bmod 91$ =32</li><li>明文 = $32^{e^{-1}} \bmod N = 32^{29} \bmod 91 = 2$</li></ul><h2 id=简单的证明>简单的证明</h2><p>用剩余类证明，略</p><h2 id=安全性>安全性</h2><p>通过公钥和密文，攻击者知道的有: N,e,c=$m^e \bmod N$</p><ul><li><p>由于素数分解很难，攻击者无法得知p,q</p></li><li><p>因此无法得知$\psi(n)$</p></li><li><p>因此无法得出$e^{-1}$</p></li></ul><h2 id=gcd>gcd()</h2><ul><li><p>最大公约数即为 Greatest Common Divisor，常缩写为 gcd。</p></li><li><p>辗转相除法（欧几里得法）</p><ul><li>假设a,b(a>b) 有公约数c 满足 c|a c|b</li><li>则a%b,b有同样的公约数c<ul><li>因为a= cm, b=cn</li><li>a % b = cm - cn$\cdot$l 依然是c的倍数</li></ul></li><li>所以我们有gcd(a, b)=gcd(b, $a \bmod b$)</li></ul></li><li><p>Example:</p><ul><li>24 和 14 的最大公约数等效于<ul><li>14 和 10 的最大公约数</li><li>10 和 4 的最大公约数</li><li>4 和 2 的最大公约数</li><li>2 和 0的 最大公约数</li><li>得出最大公约数为2</li></ul></li></ul></li><li><p>欧几里得算法（Euclidean algorithm）</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>gcd</span>(<span style=color:#66d9ef>int</span> a, <span style=color:#66d9ef>int</span> b){
  <span style=color:#66d9ef>if</span> (b<span style=color:#f92672>==</span><span style=color:#ae81ff>0</span>) <span style=color:#66d9ef>return</span> a;
  <span style=color:#66d9ef>return</span> gcd(b, a<span style=color:#f92672>%</span>b);
}
</code></pre></div></li></ul><h2 id=快速取模>快速取模</h2><ul><li><p>快速幂</p><ul><li>$3^{13} = 3^{(1101)_2}=3^8\cdot3^4\cdot3^1$</li><li>$3^{13}\bmod n=(3^8\cdot3^4\cdot3^1) \bmod n=((3^8 \bmod n) \cdot(3^4 \bmod n)\cdot(3^1 \bmod n) )\bmod n$</li><li>例子:<ul><li>计算 $2^{123} \bmod 35$</li><li>$a=2, b=123=(1111011)_2, m=35$</li><li>$x_0 = a = 2$</li><li>$x_1 = x_0^2 \bmod m = 4$</li><li>$x_2 = x_1^2 \bmod 35 = 16$</li><li>$\dots$</li><li>$x_6 = x_5^2 \bmod n =16$</li><li>$2^{123} \bmod 35 = x_0x_1x_3x_4x_5x_6 \equiv 8 \pmod {35}$</li></ul></li></ul></li><li><p>代码</p></li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span> <span style=color:#a6e22e>binpow</span>(<span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span> a, <span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span> b, <span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span> m) {
  a <span style=color:#f92672>%=</span> m;
  <span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span> res <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
  <span style=color:#66d9ef>while</span> (b <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
    <span style=color:#66d9ef>if</span> (b <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>1</span>) res <span style=color:#f92672>=</span> res <span style=color:#f92672>*</span> a <span style=color:#f92672>%</span> m; <span style=color:#75715e>//当b的当前二进制最低位为1时，即对应着二进制指数不为0时的Xi
</span><span style=color:#75715e></span>    a <span style=color:#f92672>=</span> a <span style=color:#f92672>*</span> a <span style=color:#f92672>%</span> m;
    b <span style=color:#f92672>&gt;&gt;=</span> <span style=color:#ae81ff>1</span>; <span style=color:#75715e>//b除2
</span><span style=color:#75715e></span>  }
  <span style=color:#66d9ef>return</span> res;
}
</code></pre></div><h2 id=乘法逆元>乘法逆元</h2><ul><li>如果一个线性同余方程$ax \equiv 1 \pmod b$ ，则 $x$称为$a \bmod b$ 的逆元，记作$a^{-1}$ 。</li></ul><h3 id=快速幂法>快速幂法</h3><ul><li>费马小定理: 若 p 为质数， a 为正整数，且 a、 p互质，则 $a^{p-1} \equiv 1 \pmod p$。</li><li>求解 $ax \equiv 1 \pmod b$</li><li>由费马小定理得: $ax \equiv a^{b-1} \pmod b$</li><li>$x \equiv a^{b-2} \pmod b$</li><li>因为p一定是质数，所以一定不能用于RSA</li></ul><h3 id=扩展欧几里得法>扩展欧几里得法</h3><ul><li><p>裴蜀定理: 设 a,b 是不全为零的整数，则存在整数x,y , 使得 ax+by = gcd(a,b).</p></li><li><p>扩展欧几里德定理（Extended Euclidean algorithm, EXGCD, EEA），常用于求 ax+by = gcd(a,b) 的一组可行解。</p></li><li><p><img src="https://pxsidg.sn.files.1drv.com/y4mECnW0pswd85sLIX4iP3N2Y5nkeiGsKMpnbdrDCLh_sLyqqSHdq1zxFIJjXYlBVrXkeUUm1R8mopTwVV8zDkB8PJo2vVgYVsMbGrAIgszS2H2W-wpE9RJuyTawx0ED7H1flRq1MtNSTUzX8CgNqFh-kbvhmviW1P8YOYI2VksgyHAQH8XBZ1Ctd_Ua3JwYjYPAOpfI9nkrGYdoAAGkaifSg?width=3844&height=2884&cropmode=none" alt></p></li><li><p><img src="https://pxsjdg.sn.files.1drv.com/y4m1Ey_vWtypMWlyrPM64FVBwGkZ1BGE63IPfvnGiPKmZXInERKsES5EdC7MBhmjk3qYo3clswOFDA58XlYrMMfTR28L-KaQRcDQe-Iep3El4KTbD8MADm1SkOfdEgWAoBoGJKQ6OU4bTsn0c_nlgORdRoF7sWbDt22XpynVCRukEMAxqgYYbT8B-z8xeF_8edgXD6UK0Wyys-mMtWOncJO4g?width=3844&height=2884&cropmode=none" alt></p></li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>Exgcd</span>(<span style=color:#66d9ef>int</span> a, <span style=color:#66d9ef>int</span> b, <span style=color:#66d9ef>int</span> <span style=color:#f92672>&amp;</span>x, <span style=color:#66d9ef>int</span> <span style=color:#f92672>&amp;</span>y) {
  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>b) {
    x <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
    y <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
    <span style=color:#66d9ef>return</span> a;
  }
  <span style=color:#66d9ef>int</span> d <span style=color:#f92672>=</span> Exgcd(b, a <span style=color:#f92672>%</span> b, x, y);
  <span style=color:#66d9ef>int</span> t <span style=color:#f92672>=</span> x;
  x <span style=color:#f92672>=</span> y;
  y <span style=color:#f92672>=</span> t <span style=color:#f92672>-</span> a <span style=color:#f92672>/</span> b <span style=color:#f92672>*</span> y;
  <span style=color:#66d9ef>return</span> d;
}
</code></pre></div><ul><li>以a = 12345 b=123 为例<ul><li>gcd(12345,123) = a$x_1$ + b$y_1$</li><li>gcd(123, 45) = b$x_2$ + $(a \bmod b )y_2$</li><li>$\dots$</li><li>gcd(7,0) = 7 + 0</li><li>向上反解</li></ul></li><li>求乘法逆元<ul><li>方程 $ax+by=c$与方程 $ax \equiv c \pmod b$是等价的，有整数解的充要条件为 $gcd(a,b) \mid c$。</li><li>$ax \equiv 1 \pmod b$中x称为a的逆元</li></ul></li></ul></div></article><div class=blog-post-comments><div id=disqus_thread><script type=text/javascript>(function(){var dsq=document.createElement('script');dsq.type='text/javascript';dsq.async=true;var disqus_shortname='canarypwn';dsq.src='//'+disqus_shortname+'.disqus.com/embed.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=/posts>Posts</a></li><li><a href=/tags>Tags</a></li><li><a href=/networks>Network</a></li><li><a href=/notes>Notes</a></li><li><a href=https://500px.com/p/nyovelt>Images</a></li><li><a href=/friends>Friends</a></li><li><a href=https://who.aaaab3n.moe/>About</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#what-is-rsa>What is RSA</a></li><li><a href=#how-is-rsa>How is RSA</a></li><li><a href=#private-key-and-public-key>Private Key and Public Key</a></li><li><a href=#加密解密过程>加密解密过程</a></li><li><a href=#简单的证明>简单的证明</a></li><li><a href=#安全性>安全性</a></li><li><a href=#gcd>gcd()</a></li><li><a href=#快速取模>快速取模</a></li><li><a href=#乘法逆元>乘法逆元</a><ul><li><a href=#快速幂法>快速幂法</a></li><li><a href=#扩展欧几里得法>扩展欧几里得法</a></li></ul></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2faaaab3n.moe%2fposts%2f2020-4-15-rsa%2f"><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2faaaab3n.moe%2fposts%2f2020-4-15-rsa%2f&text=RSA%20%e4%b8%8e%20%e7%ae%97%e6%b3%95"><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2faaaab3n.moe%2fposts%2f2020-4-15-rsa%2f&title=RSA%20%e4%b8%8e%20%e7%ae%97%e6%b3%95"><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2faaaab3n.moe%2fposts%2f2020-4-15-rsa%2f&is_video=false&description=RSA%20%e4%b8%8e%20%e7%ae%97%e6%b3%95"><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=RSA%20%e4%b8%8e%20%e7%ae%97%e6%b3%95&body=Check out this article: https%3a%2f%2faaaab3n.moe%2fposts%2f2020-4-15-rsa%2f"><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2faaaab3n.moe%2fposts%2f2020-4-15-rsa%2f&title=RSA%20%e4%b8%8e%20%e7%ae%97%e6%b3%95"><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2faaaab3n.moe%2fposts%2f2020-4-15-rsa%2f&title=RSA%20%e4%b8%8e%20%e7%ae%97%e6%b3%95"><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2faaaab3n.moe%2fposts%2f2020-4-15-rsa%2f&name=RSA%20%e4%b8%8e%20%e7%ae%97%e6%b3%95&description=What%20is%20RSA%20%20RSA%20%e5%8c%85%e5%90%ab%e4%ba%86%20%e5%af%86%e9%92%a5%ef%bc%88%e5%85%ac%e9%92%a5%ef%bc%8c%e7%a7%81%e9%92%a5%ef%bc%89%e7%94%9f%e6%88%90%ef%bc%8c%20%e5%8a%a0%e5%af%86%ef%bc%8c%20%e5%92%8c%e8%a7%a3%e5%af%86%e3%80%82%20%20How%20is%20RSA%20RSA%20%e7%9a%84%e8%ae%a1%e7%ae%97%e8%bf%87%e7%a8%8b%3a%0a%20%20%e9%a6%96%e5%85%88%e5%8f%96%e4%b8%a4%e4%b8%aa%e4%ba%92%e7%b4%a0%e7%9a%84%e6%95%b4%e6%95%b0%3a%20m%2c%20N%e3%80%82%0a%20m%e5%8d%b3%e8%a6%81%e5%8a%a0%e5%af%86%e7%9a%84%e4%bf%a1%e6%81%af%20%e5%85%b6%e4%b8%ad%20m%20%26lt%3b%20N%20%e4%b9%9f%e5%8f%af%e4%bb%a5%e7%90%86%e8%a7%a3%e4%b8%ba%e5%85%88%e6%89%be%e5%88%b0%e4%b8%80%e4%b8%aa%e6%ad%a3%e6%95%b4%e6%95%b0N%2c%20%e8%ae%a9%e4%bb%bb%e6%84%8f%e7%9a%84m%26lt%3bN%e4%bd%bfm%2cN%e4%ba%92%e7%b4%a0%e3%80%82%20%20%e5%85%b6%e4%b8%ad%ef%bc%8c%e4%ba%92%e7%b4%a0%e6%8c%87%e6%9c%80%e5%a4%a7%e5%85%ac%e7%ba%a6%e6%95%b0%e4%b8%ba1%ef%bc%8c%e5%8d%b3gcd%28m%2cN%29%20%3d%201%e3%80%82%20%20%20%e8%bf%99%e4%b9%9f%e6%98%afRSA%e7%ae%97%e6%b3%95%e7%9a%84%e7%9c%9f%e6%ad%a3%e8%bf%87%e7%a8%8b%20%20%20%20N%e7%9a%84%e5%8f%96%e6%b3%95%3a%20N%20%3d%20pq%2c%20%28p%2cq%20are%20prime%20numbers%29%0a%20N%20%e6%98%af%e5%87%91%e5%87%ba%e6%9d%a5%e7%9a%84%ef%bc%8c%e4%b8%ba%e4%b8%a4%e4%b8%aa%e7%b4%a0%e6%95%b0%e7%9a%84%e7%a7%af%20%20%20%20%e8%bf%99%e6%97%b6%e5%bc%95%e5%85%a5%e6%ac%a7%e6%8b%89%e5%87%bd%e6%95%b0%3a%20%24%24%20%5cphi%20%28n%29%20%3d%20%5cmid%20%5cmathbb%7bZ%7d_n%5e%2a%20%5cmid%20%24%24%0a%20%e6%9e%84%e9%80%a0%e5%87%bd%e6%95%b0%24%5cphi%28n%29%24%e8%a1%a8%e7%a4%ba%e5%b0%8f%e4%ba%8e%e7%ad%89%e4%ba%8e%20%e5%92%8c%20%e4%ba%92%e8%b4%a8%e7%9a%84%e6%95%b0%e7%9a%84%e4%b8%aa%e6%95%b0%20%e5%bd%93%20%24n%3dpq%24%20%e6%97%b6%ef%bc%8c%20%24%5cphi%28n%29%20%3d%20%28p-1%29%28q-1%29%24%20%20%e4%b8%be%e4%be%8b%ef%bc%9a"><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2faaaab3n.moe%2fposts%2f2020-4-15-rsa%2f&t=RSA%20%e4%b8%8e%20%e7%ae%97%e6%b3%95"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu class=icon href=# onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden=true></i>Menu</a>
<a id=toc class=icon href=# onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden=true></i>TOC</a>
<a id=share class=icon href=# onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden=true></i>share</a>
<a id=top style=display:none class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i>Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2022 canarypwn</div><div class=footer-right><nav><ul><li><a href=/>Home</a></li><li><a href=/posts>Posts</a></li><li><a href=/tags>Tags</a></li><li><a href=/networks>Network</a></li><li><a href=/notes>Notes</a></li><li><a href=https://500px.com/p/nyovelt>Images</a></li><li><a href=/friends>Friends</a></li><li><a href=https://who.aaaab3n.moe/>About</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script><script src=/js/main.js></script></html>